<form name="form" class="form-horizontal" novalidate>
    <div class="control-group" auth="crudOph" auth-service="APP_ORGANISAATIOHALLINTA" ng-if="model.isKoulutustoimija()">
        <div class="controls">
            <button class="btn" ng-click="haeYtjTiedot(model.organisaatio.ytunnus)">
                {{'Organisaationmuokkaus.paivitaYtj'| i18n}}
            </button>
        </div>
    </div>

    <div class="control-group">
        <label class="control-label">
            {{'Organisaationtarkastelu.organisaatiotyyppi'| i18n}}*
        </label>

        <div class="controls">
            <span ng-repeat="tyyppi in model.koodisto.organisaatiotyypit">
                <span ng-if="model.koodisto.ophOrganisaatiot.indexOf(tyyppi) > -1">
                    <input class="" type='checkbox' name="orgtyyppi"
                           auth="updateOph" auth-service="APP_ORGANISAATIOHALLINTA" auth-disable="true"
                           ng-checked="model.organisaatio.tyypit.indexOf(tyyppi) !== -1"
                           ng-click="model.toggleCheckOrganisaatio(tyyppi);
                                   form.$dirty = true">{{tyyppi}}
                </span>
                <span ng-if="(model.koodisto.ophOrganisaatiot.indexOf(tyyppi) === -1)">
                    <input type='checkbox' name="orgtyyppi"
                           ng-checked="model.organisaatio.tyypit.indexOf(tyyppi) !== -1"
                           ng-click="model.toggleCheckOrganisaatio(tyyppi);
                                   form.$dirty = true">{{tyyppi}}
                </span>
            </span>
            <div ng-if="model.organisaatio.tyypit.length === 0">
                <input type="hidden" name="orgtyypit" ng-model="orgtyypit" required>
                <span class="text-error" ng-show="form.orgtyypit.$error.required">
                    {{'Organisaationtarkastelu.organisaatiotyyppi'| i18n}}
                    {{'Organisaationmuokkaus.validointi.pakollinen'| i18n}}
                </span>
            </div>
        </div>
    </div>
    <div class="control-group" ng-if="model.isKoulutustoimija()">
        <label class="control-label">
            {{'Organisaationtarkastelu.yritysmuoto'| i18n}}
        </label>
        <div class="controls">
            <input id="ytunnus" type="text" maxlength="9" name="ytunnus"
                   ng-model="model.organisaatio.yritysmuoto"
                   ie-placeholder placeholder="{{'Organisaationtarkastelu.yritysmuoto'| i18n}}" disabled/>
        </div>
    </div>

    <div class="control-group" ng-if="model.isKoulutustoimija()">
        <label class="control-label">
            {{'Organisaationtarkastelu.ytunnus'| i18n}}
        </label>
        <div class="controls">
            <input id="ytunnus" type="text" maxlength="9" name="ytunnus"
                   ng-model="model.organisaatio.ytunnus"
                   ie-placeholder placeholder="{{'Organisaationtarkastelu.ytunnus'| i18n}}" ng-pattern="/^\d{7}-./"/>
            <div>
                <span class="text-error" ng-show="form.ytunnus.$error.pattern">
                    {{'Organisaationmuokkaus.validointi.ytunnus'| i18n}}
                </span>
            </div>
        </div>
    </div>

    <div class="control-group" ng-if="model.isKoulutustoimija()">
        <label class="control-label">
            {{'Organisaationtarkastelu.virastotunnus'| i18n}}
        </label>
        <div class="controls">
            <input id="virastotunnus" type="text" maxlength="20" name="virastotunnus"
                   ng-model="model.organisaatio.virastoTunnus"
                   ie-placeholder placeholder="{{'Organisaationtarkastelu.virastotunnus'| i18n}}" ng-pattern="/^\d{6}.*/"/>
            <div>
                <span class="text-error" ng-show="form.virastotunnus.$error.pattern">
                    {{'Organisaationmuokkaus.validointi.virastotunnus'| i18n}}
                </span>
            </div>
        </div>
    </div>

    <div class="control-group" ng-if="model.isOppilaitos()">
        <label class="control-label">
            {{'Organisaationtarkastelu.oppilaitoskoodi'| i18n}}*
        </label>
        <div class="controls">
            <input id="oppilaitoskoodi" type="text" maxlength="20" name="oppilaitoskoodi"
                   ng-model="model.organisaatio.oppilaitosKoodi"
                   ie-placeholder placeholder="{{'Organisaationtarkastelu.oppilaitoskoodi'| i18n}}" required ng-pattern="/^\d{5}$/"/>
            <div>
                <span class="text-error" ng-show="form.oppilaitoskoodi.$error.required">
                    {{'Organisaationtarkastelu.oppilaitoskoodi'| i18n}}
                    {{'Organisaationmuokkaus.validointi.pakollinen'| i18n}}
                </span>
                <span class="text-error" ng-show="form.oppilaitoskoodi.$error.pattern">
                    {{'Organisaationmuokkaus.validointi.oppilaitoskoodi'| i18n}}
                </span>
            </div>
        </div>
    </div>

    <div class="control-group" ng-if="model.isOppilaitos()">
        <label class="control-label">
            {{'Organisaationtarkastelu.oppilaitostyyppi'| i18n}}*
        </label>
        <div class="controls">
            <select id="oppilaitostyyppi" ng-model="model.organisaatio.oppilaitosTyyppiUri"
                    ng-options="olTyyppi.uri as olTyyppi.nimi for olTyyppi in model.koodisto.oppilaitostyypit | orderBy:'nimi'"
                    ng-change="model.selectOppilaitosTyyppi();
                            form.$dirty = true" required>
                <option value="">{{'Organisaationmuokkaus.valitse'| i18n}}</option>
            </select>
            <div ng-if="!model.organisaatio.oppilaitosTyyppiUri">
                <input type="hidden" name="oltyyppivirhe" ng-model="oltyyppivirhe" required>
                <span class="text-error" ng-show="form.oltyyppivirhe.$error.required">
                    {{'Organisaationtarkastelu.oppilaitostyyppi'| i18n}}
                    {{'Organisaationmuokkaus.validointi.pakollinen'| i18n}}
                </span>
            </div>
        </div>
    </div>

    <div class="control-group" ng-if="model.hasVuosiluokat()">
        <label class="control-label">
            {{'Organisaationtarkastelu.vuosiluokat'| i18n}}
        </label>
        <div class="controls">
            <div ng-repeat="vl in model.koodisto.vuosiluokat| orderBy:'nimi'">
                <div>
                    <input type='checkbox' name="vuosiluokka"
                           ng-checked="model.organisaatio.vuosiluokat.indexOf(vl.uri) !== -1"
                           ng-click="model.toggleCheckVuosiluokka(vl.uri);
                                   form.$dirty = true">{{model.uriLocalizedNames[vl.uri]}}
                </div>
            </div>
        </div>
    </div>

    <div class="control-group">
        <label class="control-label">
            {{'Organisaationtarkastelu.nimi'| i18n}}*
        </label>
        <div class="controls">
            <input type="text" name="nimifi"
                   ng-model="model.organisaatio.nimi.fi"
                   ie-placeholder placeholder="{{'Organisaationmuokkaus.nimisuomeksi'| i18n}}" ng-required="false" names-combined-field/>
            <div>
                <span class="text-error" ng-show="form.nimifi.$error.namescombinedrequired">
                    {{'Organisaationmuokkaus.ohje.nimet'| i18n}}
                </span>
            </div>
        </div>
    </div>

    <div class="control-group">
        <div class="controls">
            <input id="nimisv" type="text" name="nimisv"
                   ng-model="model.organisaatio.nimi.sv"
                   ie-placeholder placeholder="{{'Organisaationmuokkaus.nimiruotsiksi'| i18n}}" ng-required="false" names-combined-field/>
        </div>
    </div>
    <div class="control-group">
        <div class="controls">
            <input id="nimise" type="text" name="nimien"
                   ng-model="model.organisaatio.nimi.en"
                   ie-placeholder placeholder="{{'Organisaationmuokkaus.nimienglanniksi'| i18n}}" ng-required="false" names-combined-field/>
        </div>
    </div>

    <div class="control-group">
        <label class="control-label">
            {{'Organisaationtarkastelu.voimassaolo'| i18n}}*
        </label>
        <div class="controls">
            <div>
                <input type="text" name="alkupvm" datepicker-popup="dd.MM.yyyy" ng-model="model.organisaatio.alkuPvm"
                       datepicker-options="dateOptions"
                       close-on-date-selection="true" ie-placeholder placeholder="{{'Organisaationmuokkaus.luontipvm'| i18n}}"
                       close-text="{{'Organisaationmuokkaus.sulje'| i18n}}"
                       current-text="{{'Organisaationmuokkaus.tanaan'| i18n}}"
                       clear-text="{{'Organisaationmuokkaus.tyhjenna'| i18n}}"
                       toggle-weeks-text="{{'Organisaationmuokkaus.viikkonumerot'| i18n}}" required/>
                &nbsp;-&nbsp;
                <input type="text" name="lakkautuspvm" datepicker-popup="dd.MM.yyyy" ng-model="model.organisaatio.lakkautusPvm"
                       datepicker-options="dateOptions"
                       close-on-date-selection="true" ie-placeholder placeholder="{{'Organisaationmuokkaus.lakkautuspvm'| i18n}}"
                       close-text="{{'Organisaationmuokkaus.sulje'| i18n}}"
                       current-text="{{'Organisaationmuokkaus.tanaan'| i18n}}"
                       clear-text="{{'Organisaationmuokkaus.tyhjenna'| i18n}}"
                       toggle-weeks-text="{{'Organisaationmuokkaus.viikkonumerot'| i18n}}" />
            </div>
            <div>
                <em class="muted">{{'Organisaationmuokkaus.ohje.alkupvm'| i18n}}</em>
            </div>
            <div>
                <span class="text-error" ng-show="form.alkupvm.$error.required || form.alkupvm.$error.date">
                    {{'Organisaationmuokkaus.validointi.alkupvm'| i18n}}. </span>
                <span class="text-error" ng-show="form.lakkautuspvm.$error.date">
                    {{'Organisaationmuokkaus.validointi.loppupvm'| i18n}}</span>
            </div>
        </div>
    </div>

    <div class="control-group">
        <label class="control-label">
            {{'Organisaationtarkastelu.kotipaikka'| i18n}}*
        </label>
        <div class="controls">
            <select id="kotipaikka" ng-model="model.organisaatio.kotipaikkaUri"
                    ng-options="kp.uri as kp.nimi for kp in model.koodisto.kotipaikat | orderBy:'nimi'" required>
                <option value="">{{'Organisaationmuokkaus.valitse'| i18n}}</option>
            </select>
            <div ng-if="!model.organisaatio.kotipaikkaUri">
                <input type="hidden" name="kotipaikkavirhe" ng-model="kotipaikkavirhe" required>
                <span class="text-error" ng-show="form.kotipaikkavirhe.$error.required">
                    {{'Organisaationtarkastelu.kotipaikka'| i18n}}
                    {{'Organisaationmuokkaus.validointi.pakollinen'| i18n}}
                </span>
            </div>
        </div>
    </div>

    <div class="control-group">
        <label class="control-label">
            {{'Organisaationtarkastelu.maa'| i18n}}*
        </label>
        <div class="controls">
            <select id="maa" ng-model="model.organisaatio.maaUri"
                    ng-options="maa.uri as maa.nimi for maa in model.koodisto.maat | orderBy:'nimi'" required>
                <option value="">{{'Organisaationmuokkaus.valitse'| i18n}}</option>
            </select>
            <div>
                <em class="muted">{{'Organisaationmuokkaus.ohje.maa'| i18n}}</em>
            </div>
            <div ng-if="!model.organisaatio.maaUri">
                <input type="hidden" name="maavirhe" ng-model="maavirhe" required>
                <span class="text-error" ng-show="form.maavirhe.$error.required">
                    {{'Organisaationtarkastelu.maa'| i18n}}
                    {{'Organisaationmuokkaus.validointi.pakollinen'| i18n}}
                </span>
            </div>
        </div>
    </div>

    <div class="control-group">
        <label class="control-label">
            {{'Organisaationtarkastelu.kieli'| i18n}}*
        </label>
        <div class="controls">
            <span ng-repeat="kieli in model.organisaatio.kieletUris" >
                <!--span class="removabletag">{{model.uriLocalizedNames[kieli]}}</span-->
                <button type="button" class="btn btn-small" ng-click="model.removeLang(kieli);
                        form.$dirty = true">{{model.uriLocalizedNames[kieli]}}&nbsp;<i class="icon-remove"></i></button>
            </span>
            <select id="maa" ng-model="model.koodisto.kieliplaceholder"
                    ng-options="kieli.uri as kieli.nimi for kieli in model.koodisto.opetuskielet | orderBy:'nimi'" ng-required="false"
                    ng-click="model.addLang()">
                <option value="">{{'Organisaationmuokkaus.lisaakieli'| i18n}}</option>
            </select>
            <div ng-if="model.organisaatio.kieletUris.length === 0">
                <input type="hidden" name="kielivirhe" ng-model="kielivirhe" required>
                <span class="text-error" ng-show="form.kielivirhe.$error.required">
                    {{'Organisaationtarkastelu.kieli'| i18n}}
                    {{'Organisaationmuokkaus.validointi.pakollinen'| i18n}}
                </span>
            </div>
        </div>
    </div>

    <!-- TODO: käännä vertailu kun tabit tehty: model.yhteystietokieli === 'fi' -->
    <div ng-if="model.yhteystietokieli !== 'fi'">
        <div class="control-group">
            <label class="control-label">
                {{'Organisaationtarkastelu.kayntiosoite'| i18n}}
            </label>
            <div class="controls">
                <input id="kayntiosoitefi" type="text" maxlength="30" name="kayntiosoitefi"
                       ng-model="model.yhteystiedot.kaynti.osoite" ng-change="model.copyAddress(false)"
                       ie-placeholder placeholder="{{'Organisaationmuokkaus.osoitesuomeksi'| i18n}}"/>
                &nbsp;&nbsp;&nbsp;
                <input id="kayntipostifi" name="kayntipostifi" type="text" ng-model="model.yhteystiedot.postinumerot.kaynti"
                       typeahead="nro for nro in model.koodisto.postinumerot | filter:$viewValue | limitTo:10"
                       ie-placeholder placeholder="{{'Organisaationmuokkaus.postinumero'| i18n}}" typeahead-editable="false"
                       typeahead-on-select="model.setPostinumero(false, model.yhteystiedot.kaynti, model.yhteystiedot.postinumerot.kaynti)">
                &nbsp;{{model.getLocalizedPaikka(model.yhteystiedot.postinumerot.kaynti)}}
            </div>
        </div>

        <div class="control-group">
            <label class="control-label">
                {{'Organisaationtarkastelu.postiosoite'| i18n}}
            </label>
            <div class="controls">
                <input id="postiosoitefi" type="text" maxlength="30" name="postiosoitefi"
                       ng-model="model.yhteystiedot.posti.osoite" ng-disabled="model.samaosoite === true"
                       ie-placeholder placeholder="{{'Organisaationmuokkaus.osoitesuomeksi'| i18n}}"/>
                &nbsp;&nbsp;&nbsp;
                <input id="postipostifi" name="postipostifi" type="text" ng-model="model.yhteystiedot.postinumerot.posti"
                       ng-disabled="model.samaosoite === true"
                       typeahead="nro for nro in model.koodisto.postinumerot | filter:$viewValue | limitTo:10"
                       ie-placeholder placeholder="{{'Organisaationmuokkaus.postinumero'| i18n}}" typeahead-editable="false"
                       typeahead-on-select="model.setPostinumero(false, model.yhteystiedot.posti, model.yhteystiedot.postinumerot.posti)">
                &nbsp;{{model.getLocalizedPaikka(model.yhteystiedot.postinumerot.posti)}}
                <div>
                    <input type='checkbox' ng-model="model.samaosoite" ng-init="model.samaosoite = false"
                           ng-change="model.copyAddress(false)"/>{{'Organisaationmuokkaus.samaosoite'| i18n}}
                </div>
            </div>
        </div>

        <div class="control-group" ng-if="kayntiosoitefi.$error.addresscombinedrequired">
            <div class="controls">
                <input type="hidden" name="osoitevirhe" ng-model="osoitevirhemodel" required>
                <span class="text-error" ng-show="osoitevirhe.$error.required">
                    {{label| i18n}}
                    {{'Organisaationmuokkaus.validointi.pakollinen'| i18n}}
                </span>
            </div>
        </div>
    </div>

    <!-- TODO: käännä vertailu kun tabit tehty: model.yhteystietokieli === 'sv' -->
    <div ng-if="model.yhteystietokieli !== 'sv'">
        <div class="control-group">
            <label class="control-label">
                {{'Organisaationtarkastelu.kayntiosoite'| i18n}}
            </label>
            <div class="controls">
                <input id="kayntiosoitesv" type="text" maxlength="30" name="kayntiosoitesv" ng-change="model.copyAddressSv(false)"
                       ng-model="model.yhteystiedot.ruotsi_kaynti.osoite"
                       ie-placeholder placeholder="{{'Organisaationmuokkaus.osoiteruotsiksi'| i18n}}"/>
                &nbsp;&nbsp;&nbsp;
                <input id="kayntipostisv" name="kayntipostisv" type="text" ng-model="model.yhteystiedot.postinumerot.ruotsi_kaynti"
                       typeahead="nro for nro in model.koodisto.postinumerot | filter:$viewValue | limitTo:10"
                       ie-placeholder placeholder="{{'Organisaationmuokkaus.postinumero'| i18n}}" typeahead-editable="false"
                       typeahead-on-select="model.setRuotsiPostinumero(false, model.yhteystiedot.ruotsi_kaynti, model.yhteystiedot.postinumerot.ruotsi_kaynti)">
                &nbsp;{{model.getLocalizedPaikkaSv(model.yhteystiedot.postinumerot.ruotsi_kaynti)}}
            </div>
        </div>

        <div class="control-group">
            <label class="control-label">
                {{'Organisaationtarkastelu.postiosoite'| i18n}}
            </label>
            <div class="controls">
                <input id="postiosoitesv" type="text" maxlength="30" name="postiosoitesv"
                       ng-model="model.yhteystiedot.ruotsi_posti.osoite" ng-disabled="model.samaosoitesv === true"
                       ie-placeholder placeholder="{{'Organisaationmuokkaus.osoiteruotsiksi'| i18n}}"/>
                &nbsp;&nbsp;&nbsp;
                <input id="postipostisv" name="postipostisv" type="text" ng-model="model.yhteystiedot.postinumerot.ruotsi_posti"
                       ng-disabled="model.samaosoitesv === true"
                       typeahead="nro for nro in model.koodisto.postinumerot | filter:$viewValue | limitTo:10"
                       ie-placeholder placeholder="{{'Organisaationmuokkaus.postinumero'| i18n}}" typeahead-editable="false"
                       typeahead-on-select="model.setRuotsiPostinumero(false, model.yhteystiedot.ruotsi_posti, model.yhteystiedot.postinumerot.ruotsi_posti)">
                &nbsp;{{model.getLocalizedPaikkaSv(model.yhteystiedot.postinumerot.ruotsi_posti)}}
                <div>
                    <input type='checkbox' ng-model="model.samaosoitesv" ng-init="model.samaosoitesv = false"
                           ng-change="model.copyAddressSv(false)"/>{{'Organisaationmuokkaus.samaosoite'| i18n}}
                </div>
            </div>
        </div>

        <div class="control-group" ng-if="kayntiosoitesv.$error.addresscombinedrequired">
            <div class="controls">
                <input type="hidden" name="osoitevirhe" ng-model="osoitevirhemodel" required>
                <span class="text-error" ng-show="osoitevirhe.$error.required">
                    {{label| i18n}}
                    {{'Organisaationmuokkaus.validointi.pakollinen'| i18n}}
                </span>
            </div>
        </div>
    </div>

    <div ng-if="model.yhteystietokieli !== 'fi' && model.yhteystietokieli !== 'sv'">
        <div class="control-group">
            <label class="control-label">
                {{'Organisaationtarkastelu.kayntiosoite'| i18n}}
            </label>
            <div class="controls">
                <textarea id="kvkayntiosoite" name="kvkayntiosoite" rows="6" ng-model="model.yhteystiedot.ulkomainen_kaynti.osoite"
                          ng-disabled="disabled" ng-change="model.copyAddressKv(false)"
                          ie-placeholder placeholder="{{'Organisaationmuokkaus.osoiteenglanniksi'| i18n}}"></textarea>
            </div>
        </div>
        <div class="control-group">
            <label class="control-label">
                {{'Organisaationtarkastelu.postiosoite'| i18n}}
            </label>
            <div class="controls">
                <textarea id="kvpostiosoite" name="kvpostiosoite" rows="6" ng-model="model.yhteystiedot.ulkomainen_posti.osoite"
                          ng-disabled="model.samaosoitekv === true"
                          ie-placeholder placeholder="{{'Organisaationmuokkaus.osoiteenglanniksi'| i18n}}"></textarea>
                <div>
                    <input type='checkbox' ng-model="model.samaosoitekv" ng-init="model.samaosoitekv = false"
                           ng-change="model.copyAddressKv(false)"/>{{'Organisaationmuokkaus.samaosoite'| i18n}}
                </div>
            </div>
        </div>

        <div class="control-group" ng-if="kayntiosoitefi.$error.addresscombinedrequired">
            <div class="controls">
                <input type="hidden" name="osoitevirhe" ng-model="osoitevirhemodel" required>
                <span class="text-error" ng-show="osoitevirhe.$error.required">
                    {{label| i18n}}
                    {{'Organisaationmuokkaus.validointi.pakollinen'| i18n}}
                </span>
            </div>
        </div>
    </div>

    <div class="control-group">
        <label class="control-label">
            {{'Organisaationtarkastelu.puhelinnumero'| i18n}}
        </label>
        <div class="controls">
            <input id="puhelinnumero" type="text" name="puhelinnumero"
                   ng-model="model.yhteystiedot.puhelin.numero" oph-null-if-zero-length
                   ie-placeholder placeholder="{{'Organisaationtarkastelu.puhelinnumero'| i18n}}" ng-pattern="/^[\d \-\+]+$/"/>
            <div>
                <span class="text-error" ng-show="form.puhelinnumero.$error.pattern">
                    {{'Organisaationtarkastelu.puhelinnumero'| i18n}}
                    {{'Organisaationmuokkaus.validointi.virheellinen'| i18n}}
                </span>
            </div>
        </div>
    </div>

    <div class="control-group">
        <label class="control-label">
            {{'Organisaationtarkastelu.faksinumero'| i18n}}
        </label>
        <div class="controls">
            <input id="faksinumero" type="text" maxlength="20" name="faksinumero"
                   ng-model="model.yhteystiedot.faksi.numero" oph-null-if-zero-length
                   ie-placeholder placeholder="{{'Organisaationtarkastelu.faksinumero'| i18n}}" ng-pattern="/^[\d \-\+]+$/"/>
            <div>
                <span class="text-error" ng-show="form.faksinumero.$error.pattern">
                    {{'Organisaationtarkastelu.faksinumero'| i18n}}
                    {{'Organisaationmuokkaus.validointi.virheellinen'| i18n}}
                </span>
            </div>
        </div>
    </div>

    <div class="control-group">
        <label class="control-label">
            {{'Organisaationtarkastelu.sahkopostiosoite'| i18n}}
        </label>
        <div class="controls">
            <input id="sahkopostiosoite" type="email" name="sahkopostiosoite"
                   ng-model="model.yhteystiedot.email.email" oph-null-if-zero-length
                   ie-placeholder placeholder="{{'Organisaationtarkastelu.sahkopostiosoite'| i18n}}"/>
            <div>
                <span class="text-error" ng-show="form.sahkopostiosoite.$error.email">
                    {{'Organisaationtarkastelu.sahkopostiosoite'| i18n}}
                    {{'Organisaationmuokkaus.validointi.pakollinen'| i18n}}
                </span>
            </div>
        </div>
    </div>

    <div class="control-group">
        <label class="control-label">
            {{'Organisaationtarkastelu.wwwosoite'| i18n}}
        </label>
        <div class="controls">
            <input id="wwwosoite" type="text" name="wwwosoite"
                   ng-model="model.yhteystiedot.www.www" oph-null-if-zero-length
                   ie-placeholder placeholder="{{'Organisaationtarkastelu.wwwosoite'| i18n}}" ng-required="false" codes-combined-field/>
            <div>
                <span class="text-error" ng-show="form.oppilaitoskoodi.$error.codescombinedrequired">
                    {{'codes.validation.codescombinedrequired'| i18n}}</span>
            </div>
        </div>
    </div>

    <div class="control-group" ng-repeat="yttyyppi in model.lisayhteystiedot">
        <label class="control-label">
            {{yttyyppi.nimi}}
        </label>
        <div class="controls well">
            <div class="control-group" ng-repeat="yt in model.organisaatio.yhteystietoArvos" ng-show="yt['YhteystietojenTyyppi.oid'] === yttyyppi.oid"
                 ng-form="ytForm">
                <label class="control-label">
                    {{model.uriLocalizedNames[yt['YhteystietoElementti.oid']]}}
                </label>
                <div class="controls">
                    <input type="text" name="name"
                           ng-model="yt['YhteystietoArvo.arvoText']" ng-required='yt["YhteystietoElementti.pakollinen"]==="true"'>
                    <div>
                        <span class="text-error" ng-show="ytForm.name.$error.required">
                            {{model.uriLocalizedNames[yt['YhteystietoElementti.oid']]}}
                            {{'Organisaationmuokkaus.validointi.pakollinen'| i18n}}
                        </span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <hr>
    <div class="row">
        <div class="span4">
            <div>
                <a href="" ng-model="ktexpanded" ng-click="ktexpanded = !ktexpanded">
                    <label ng-show="!ktexpanded">
                        <span class="icon-chevron-right"></span> {{'Organisaationtarkastelu.koulutustarjoajatiedot'| i18n}}
                    </label>
                    <label ng-show="ktexpanded">
                        <span class="icon-chevron-down"></span> {{'Organisaationtarkastelu.koulutustarjoajatiedot'| i18n}}
                    </label>
                </a>
            </div>
        </div>
    </div>

    <div ng-show="ktexpanded">

        <div class="control-group">
            <label class="control-label">
                {{'Organisaationtarkastelu.kuva'| i18n}}
            </label>
            <div class="controls">
                <div ng-show="model.organisaatio.metadata.kuvaEncoded">
                    <img ng-src="data:image/jpeg;base64, {{model.organisaatio.metadata.kuvaEncoded}}">
                </div>
                <div ng-controller="UploadController">
                    <label ng-show="model.organisaatio.metadata.kuvaEncoded" for="upload" class="btn" style="text-align: center">{{ 'Organisaationmuokkaus.vaihdakuva' | i18n}}</label>
                    <label ng-hide="model.organisaatio.metadata.kuvaEncoded" for="upload" class="btn" style="text-align: center">{{ 'Organisaationmuokkaus.lisaakuva' | i18n}}</label>
                    <input style="display: none;" type="file" name="upload" id="upload" ng-model="model.imagefile" ng-file-select="onFileSelect($files)">
                    <button ng-show="model.organisaatio.metadata.kuvaEncoded" type="button" class="btn" ng-click="model.removeImage()">{{ 'Organisaationmuokkaus.poistakuva' | i18n}}</button>
                </div>
            </div>
        </div>

        <div class="control-group">
            <label class="control-label">
                {{'Organisaationtarkastelu.hakutoimistonnimi'| i18n}}
            </label>

            <div class="controls">
                <input id="htnimifi" type="text" name="htnimifi"
                       ng-model="model.organisaatio.metadata.hakutoimistonNimi.kielivalikoima_fi"
                       ie-placeholder placeholder="{{'Organisaationmuokkaus.nimisuomeksi'| i18n}}" ng-required="false"/>
            </div>
        </div>
        <div class="control-group">
            <div class="controls">
                <input id="htnimisv" type="text" name="htnimisv"
                       ng-model="model.organisaatio.metadata.hakutoimistonNimi.kielivalikoima_sv"
                       ie-placeholder placeholder="{{'Organisaationmuokkaus.nimiruotsiksi'| i18n}}" ng-required="false"/>
            </div>
        </div>
        <div class="control-group">
            <div class="controls">
                <input id="htnimien" type="text" name="htnimien"
                       ng-model="model.organisaatio.metadata.hakutoimistonNimi.kielivalikoima_en"
                       ie-placeholder placeholder="{{'Organisaationmuokkaus.nimienglanniksi'| i18n}}" ng-required="false"/>
            </div>
        </div>



        <!-- TODO: käännä vertailu kun tabit tehty: model.mdyhteystietokieli === 'fi' -->
        <div ng-if="model.mdyhteystietokieli !== 'fi'">
            <div class="control-group">
                <label class="control-label">
                    {{'Organisaationtarkastelu.kayntiosoite'| i18n}}
                </label>
                <div class="controls">
                    <input id="mdkayntiosoitekv" type="text" maxlength="30" name="mdkayntiosoitekv"
                           ng-model="model.mdyhteystiedot.kaynti.osoite" ng-change="model.copyAddress(true)"
                           ie-placeholder placeholder="{{'Organisaationmuokkaus.osoitesuomeksi'| i18n}}"/>
                    &nbsp;&nbsp;&nbsp;
                    <input id="mdkayntipostifi" name="mdkayntipostifi" type="text" ng-model="model.mdyhteystiedot.postinumerot.kaynti"
                           typeahead="nro for nro in model.koodisto.postinumerot | filter:$viewValue | limitTo:10"
                           ie-placeholder placeholder="{{'Organisaationmuokkaus.postinumero'| i18n}}" typeahead-editable="false"
                           typeahead-on-select="model.setPostinumero(true, model.mdyhteystiedot.kaynti, model.mdyhteystiedot.postinumerot.kaynti)">
                    &nbsp;{{model.mdyhteystiedot.kaynti.postitoimipaikka}}
                </div>
            </div>

            <div class="control-group">
                <label class="control-label">
                    {{'Organisaationtarkastelu.postiosoite'| i18n}}
                </label>
                <div class="controls">
                    <input id="mdpostiosoitefi" type="text" maxlength="30" name="mdpostiosoitefi"
                           ng-model="model.mdyhteystiedot.posti.osoite" ng-disabled="model.mdsamaosoite === true"
                           ie-placeholder placeholder="{{'Organisaationmuokkaus.osoitesuomeksi'| i18n}}"/>
                    &nbsp;&nbsp;&nbsp;
                    <input id="mdpostipostifi" name="mdpostipostifi" type="text" ng-model="model.mdyhteystiedot.postinumerot.posti"
                           ng-disabled="model.mdsamaosoite === true"
                           typeahead="nro for nro in model.koodisto.postinumerot | filter:$viewValue | limitTo:10"
                           ie-placeholder placeholder="{{'Organisaationmuokkaus.postinumero'| i18n}}" typeahead-editable="false"
                           typeahead-on-select="model.setPostinumero(true, model.mdyhteystiedot.posti, model.mdyhteystiedot.postinumerot.posti)">
                    &nbsp;{{model.mdyhteystiedot.posti.postitoimipaikka}}
                    <div>
                        <input type='checkbox' ng-model="model.mdsamaosoite" ng-init="model.mdsamaosoite = false"
                               ng-change="model.copyAddress(true)"/>{{'Organisaationmuokkaus.samaosoite'| i18n}}
                    </div>
                </div>
            </div>

            <div class="control-group" ng-if="kayntiosoitefi.$error.addresscombinedrequired">
                <div class="controls">
                    <input type="hidden" name="osoitevirhe" ng-model="osoitevirhemodel" required>
                    <span class="text-error" ng-show="osoitevirhe.$error.required">
                        {{label| i18n}}
                        {{'Organisaationmuokkaus.validointi.pakollinen'| i18n}}
                    </span>
                </div>
            </div>
        </div>

        <!-- TODO: käännä vertailu kun tabit tehty: model.mdyhteystietokieli === 'sv' -->
        <div ng-if="model.mdyhteystietokieli !== 'sv'">
            <div class="control-group">
                <label class="control-label">
                    {{'Organisaationtarkastelu.kayntiosoite'| i18n}}
                </label>
                <div class="controls">
                    <input id="mdkayntiosoitesv" type="text" maxlength="30" name="mdkayntiosoitesv" ng-change="model.copyAddressSv(true)"
                           ng-model="model.mdyhteystiedot.ruotsi_kaynti.osoite"
                           ie-placeholder placeholder="{{'Organisaationmuokkaus.osoiteruotsiksi'| i18n}}"/>
                    &nbsp;&nbsp;&nbsp;
                    <input id="mdkayntipostisv" name="mdkayntipostisv" type="text" ng-model="model.mdyhteystiedot.postinumerot.ruotsi_kaynti"
                           typeahead="nro for nro in model.koodisto.postinumerot | filter:$viewValue | limitTo:10"
                           ie-placeholder placeholder="{{'Organisaationmuokkaus.postinumero'| i18n}}" typeahead-editable="false"
                           typeahead-on-select="model.setRuotsiPostinumero(true, model.mdyhteystiedot.ruotsi_kaynti, model.mdyhteystiedot.postinumerot.ruotsi_kaynti)">
                    &nbsp;{{model.mdyhteystiedot.ruotsi_kaynti.postitoimipaikka}}
                </div>
            </div>

            <div class="control-group">
                <label class="control-label">
                    {{'Organisaationtarkastelu.postiosoite'| i18n}}
                </label>
                <div class="controls">
                    <input id="mdpostiosoitesv" type="text" maxlength="30" name="mdpostiosoitesv"
                           ng-model="model.mdyhteystiedot.ruotsi_posti.osoite" ng-disabled="model.mdsamaosoitesv === true"
                           ie-placeholder placeholder="{{'Organisaationmuokkaus.osoiteruotsiksi'| i18n}}"/>
                    &nbsp;&nbsp;&nbsp;
                    <input id="mdpostipostisv" name="mdpostipostisv" type="text" ng-model="model.mdyhteystiedot.postinumerot.ruotsi_posti"
                           ng-disabled="model.mdsamaosoitesv === true"
                           typeahead="nro for nro in model.koodisto.postinumerot | filter:$viewValue | limitTo:10"
                           ie-placeholder placeholder="{{'Organisaationmuokkaus.postinumero'| i18n}}" typeahead-editable="false"
                           typeahead-on-select="model.setRuotsiPostinumero(true, model.mdyhteystiedot.ruotsi_posti, model.mdyhteystiedot.postinumerot.ruotsi_posti)">
                    &nbsp;{{model.mdyhteystiedot.ruotsi_posti.postitoimipaikka}}
                    <div>
                        <input type='checkbox' ng-model="model.mdsamaosoitesv" ng-init="model.mdsamaosoitesv = false"
                               ng-change="model.copyAddressSv(true)"/>{{'Organisaationmuokkaus.samaosoite'| i18n}}
                    </div>
                </div>
            </div>

            <div class="control-group" ng-if="kayntiosoitesv.$error.addresscombinedrequired">
                <div class="controls">
                    <input type="hidden" name="osoitevirhe" ng-model="osoitevirhemodel" required>
                    <span class="text-error" ng-show="osoitevirhe.$error.required">
                        {{label| i18n}}
                        {{'Organisaationmuokkaus.validointi.pakollinen'| i18n}}
                    </span>
                </div>
            </div>
        </div>

        <div ng-if="model.mdyhteystietokieli !== 'fi' && model.mdyhteystietokieli !== 'sv'">
            <div class="control-group">
                <label class="control-label">
                    {{'Organisaationtarkastelu.kayntiosoite'| i18n}}
                </label>
                <div class="controls">
                    <textarea id="mdkvkayntiosoite" name="mdkvkayntiosoite" rows="6" ng-model="model.mdyhteystiedot.ulkomainen_kaynti.osoite"
                              ng-disabled="disabled" ng-change="model.copyAddressKv(true)"
                              ie-placeholder placeholder="{{'Organisaationmuokkaus.osoiteenglanniksi'| i18n}}"></textarea>
                </div>
            </div>
            <div class="control-group">
                <label class="control-label">
                    {{'Organisaationtarkastelu.postiosoite'| i18n}}
                </label>
                <div class="controls">
                    <textarea id="mdkvpostiosoite" name="mdkvpostiosoite" rows="6" ng-model="model.mdyhteystiedot.ulkomainen_posti.osoite"
                              ng-disabled="model.mdsamaosoitekv === true"
                              ie-placeholder placeholder="{{'Organisaationmuokkaus.osoiteenglanniksi'| i18n}}"></textarea>
                    <div>
                        <input type='checkbox' ng-model="model.mdsamaosoitekv" ng-init="model.mdsamaosoitekv = false"
                               ng-change="model.copyAddressKv(true)"/>{{'Organisaationmuokkaus.samaosoite'| i18n}}
                    </div>
                </div>
            </div>

            <div class="control-group" ng-if="kayntiosoitefi.$error.addresscombinedrequired">
                <div class="controls">
                    <input type="hidden" name="osoitevirhe" ng-model="osoitevirhemodel" required>
                    <span class="text-error" ng-show="osoitevirhe.$error.required">
                        {{label| i18n}}
                        {{'Organisaationmuokkaus.validointi.pakollinen'| i18n}}
                    </span>
                </div>
            </div>
        </div>

        <div class="control-group">
            <label class="control-label">
                {{'Organisaationtarkastelu.hakutoimistoectsnimi'| i18n}}
            </label>
            <div class="controls">
                <input id="ectsnimi" name="ectsnimi" type="text" ng-model="model.organisaatio.metadata.hakutoimistoEctsNimi"
                       typeahead="hlo.nimi for hlo in model.henkilot.virkailijat | filter:$viewValue | limitTo:10"
                       ie-placeholder placeholder="{{'Organisaationmuokkaus.hakutoimistoectsnimi'| i18n}}"
                       typeahead-on-select="model.setEctsNimi($item)">
                <input id="ectsnimike" type="text" name="ectsnimike"
                       ng-model="model.organisaatio.metadata.hakutoimistoEctsTehtavanimike"
                       ie-placeholder placeholder="{{'Organisaationmuokkaus.hakutoimistoectstehtavanimike'| i18n}}" ng-required="false" codes-combined-field/>
            </div>

            <div>
                <span class="text-error" ng-show="form.nimifi.$error.codescombinedrequired">
                    {{'codes.validation.codescombinedrequired'| i18n}}</span>
                <span class="text-error" ng-show="form.nimifi.$error.codescombinedrequired">
                    {{'codes.validation.codescombinedrequired'| i18n}}</span>
            </div>
        </div>
        <div class="control-group">
            <div class="controls">
                <input id="ectspuhelin" type="text" name="ectspuhelin"
                       ng-model="model.organisaatio.metadata.hakutoimistoEctsPuhelin"
                       ie-placeholder placeholder="{{'Organisaationmuokkaus.hakutoimistoectspuhelin'| i18n}}" ng-required="false" codes-combined-field/>
                <span class="text-error" ng-show="form.nimifi.$error.codescombinedrequired">
                    {{'codes.validation.codescombinedrequired'| i18n}}</span>
            </div>
        </div>
        <div class="control-group">
            <div class="controls">
                <div>
                    <input id="ectsemail" type="text" name="ectsemail"
                           ng-model="model.organisaatio.metadata.hakutoimistoEctsEmail"
                           ie-placeholder placeholder="{{'Organisaationmuokkaus.hakutoimistoectsemail'| i18n}}" ng-required="false" codes-combined-field/>
                    <span class="text-error" ng-show="form.nimifi.$error.codescombinedrequired">
                        {{'codes.validation.codescombinedrequired'| i18n}}</span>
                </div>
            </div>
        </div>
        <div class="control-group">
            <label class="control-label">
                {{'Organisaationtarkastelu.sosiaalinenmedia'| i18n}}
            </label>
            <div class="controls">
                <select id="some" ng-model="model.someplaceholder"
                        ng-options="some.type as some.nimi for some in model.some | orderBy:'some.nimi'" ng-required="false"
                        ng-click="model.addSome()">
                    <option value="">{{'Organisaationmuokkaus.lisaasosiaalinenmedia'| i18n}}</option>
                </select>
                <div ng-repeat="(k,v) in model.organisaatio.metadata.data">
                    <div ng-if="['FACEBOOK', 'GOOGLE_PLUS', 'LINKED_IN', 'TWITTER', 'MUU'].indexOf(k) > -1">
                        <div ng-repeat="(k2,v2) in v">
                            <br />{{'Organisaationtarkastelu.' + k| i18n }}:<br />
                            <div class="input-append">
                                <input id="some_{{k}}" type="text" name="some_{{k}}"
                                       ng-model="model.organisaatio.metadata.data[k][k2]"
                                       ie-placeholder placeholder="{{'Organisaationtarkastelu.sosiaalinenmedia'| i18n}}" ng-required="false" codes-combined-field/>
                                <!-- {{ 'Organisaationmuokkaus.poistasome' | i18n}}-->
                                <button type="button" class="btn" ng-click="model.removeSome(k)"><i class="icon-remove"></i></button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="control-group">
            <label class="control-label">
                {{'Organisaationmuokkaus.lisatiedot'| i18n}}
            </label>
            <div class="controls">
                <tabset>
                    <tab select="model.ktlang='+'">
                        <tab-heading>
                            <span class="dropdown">
                                <span class="icon-plus-sign dropdown-toggle"></span>
                                <ul ng-if="true" class="dropdown-menu" style="text-decoration: none">
                                    <li
                                        ng-repeat="kieli in model.koodisto.kielet| orderBy:'nimi'">
                                        <a href="" ng-click="model.koodisto.ktkieliplaceholder = kieli.uri;
                                                    model.addKtLang()">{{kieli.nimi}}</a>
                                    </li>
                                </ul>
                            </span>
                        </tab-heading>
                    </tab>
                    <tab ng-repeat="tab in model.kttabs"
                         active="tab.active"
                         select="model.ktlang=tab.lang">
                        <tab-heading>
                            {{model.uriLocalizedNames[tab.lang]}} <a ng-click="model.removeKtLang($index)" href=''><span class='icon-remove'>&nbsp;</span></a>
                        </tab-heading>
                    </tab>
                </tabset>
                <div ng-if="model.ktlang === '+'">
                    <div class="control-group">
                        <select id="maa" ng-model="model.koodisto.ktkieliplaceholder"
                                ng-options="kieli.uri as kieli.nimi for kieli in model.koodisto.kielet | orderBy:'nimi'" ng-required="false"
                                ng-click="model.addKtLang()">
                            <option value="">{{'Organisaationmuokkaus.lisaakieli'| i18n}}</option>
                        </select>
                    </div>
                </div>
                <div ng-if="model.ktlang !== '+'" ng-repeat='tab in model.kttabs'>
                    <div ng-if='tab.lang === model.ktlang'>

                        <div class="control-group" ng-repeat="field in model.kttypes">
                            <label class="control-label">
                                {{'Organisaationtarkastelu.' + field| i18n}}
                            </label>
                            <div class="controls">
                                <em class="muted">{{'Organisaationmuokkaus.ohje.' + field| i18n}}</em>
                            </div>
                            <label class="control-label">&nbsp;</label>
                            <div class="controls">
                                <textarea id="kt_{{field}}}}" ui-tinymce='{menubar:"false"}' ng-model="model.organisaatio.metadata.data[field][model.ktlang]"></textarea>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <hr>
    </div> <!-- ktexpanded -->

    <div class="view-row"></div>

    <div class="row">
        <div class="span4">
            <div class="view-row-label">
                <a href="" ng-model="oeexpanded" ng-click="oeexpanded = !oeexpanded">
                    <label  ng-show="!oeexpanded">
                        <span class="icon-chevron-right"></span> {{'Organisaationtarkastelu.opiskelijanedut'| i18n}}
                    </label>
                    <label ng-show="oeexpanded">
                        <span class="icon-chevron-down"></span> {{'Organisaationtarkastelu.opiskelijanedut'| i18n}}
                    </label>
                </a>
            </div>
        </div>
    </div>

    <div ng-show="oeexpanded">
        <div class="control-group">
            <div class="controls">
                <div>
                    <em class="muted">{{'Organisaationmuokkaus.ohje.palvelutoppijalle'| i18n}}</em>
                </div>

                <tabset>
                    <tab select="model.oelang='+'">
                        <tab-heading>
                            <span class="dropdown">
                                <span class="icon-plus-sign dropdown-toggle"></span>
                                <ul ng-if="true" class="dropdown-menu" style="text-decoration: none">
                                    <li
                                        ng-repeat="kieli in model.koodisto.kielet| orderBy:'nimi'">
                                        <a href="" ng-click="model.koodisto.oekieliplaceholder = kieli.uri;
                                                    model.addOeLang()">{{kieli.nimi}}</a>
                                    </li>
                                </ul>
                            </span>
                        </tab-heading>
                    </tab>
                    <tab ng-repeat="tab in model.oetabs"
                         active="tab.active"
                         select="model.oelang=tab.lang">
                        <tab-heading>
                            {{model.uriLocalizedNames[tab.lang]}} <a ng-click="model.removeOeLang($index)" href=''><span class='icon-remove'>&nbsp;</span></a>
                        </tab-heading>
                    </tab>
                </tabset>

                <div ng-if="model.oelang === '+'">
                    <div class="control-group">
                        <select id="maa" ng-model="model.koodisto.oekieliplaceholder"
                                ng-options="kieli.uri as kieli.nimi for kieli in model.koodisto.kielet | orderBy:'nimi'" ng-required="false"
                                ng-click="model.addOeLang()">
                            <option value="">{{'Organisaationmuokkaus.lisaakieli'| i18n}}</option>
                        </select>
                    </div>
                </div>

                <div ng-if="model.oelang !== '+'" ng-repeat='tab in model.oetabs'>
                    <div ng-if='tab.lang === model.oelang'>

                        <div class="control-group" ng-repeat="field in model.oetypes">
                            <label class="control-label">
                                {{'Organisaationtarkastelu.' + field| i18n}}
                            </label>
                            <div class="controls">
                                <em class="muted">{{'Organisaationmuokkaus.ohje.' + field| i18n}}</em>
                            </div>
                            <label class="control-label">&nbsp;</label>
                            <div class="controls">
                                <textarea id="oe_{{field}}}}" ui-tinymce='{menubar:"false"}' ng-model="model.organisaatio.metadata.data[field][model.oelang]"></textarea>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <hr>
    </div> <!-- oeexpanded -->



    <div class="row">&nbsp;</div>
    <div class="row">&nbsp;</div>
</form>
<!-- Fixed footer ei näytä hyvältä virkailija framessa...
<div class="view-row fixed-footer" ng-show="model.organisaatio.nimi">
    <hr>
    <br>
    <div class="align-right margin-right-10">
        <button type="button" class="button small" ng-click="cancel()">{{'Organisaationmuokkaus.peruuta'| i18n}}</button>
        <button type="button" class="button small" ng-click="save()">{{'Organisaationmuokkaus.tallenna'| i18n}}</button>
    </div>
    <p>
</div>
-->

<div class="row fixed-right" ng-if="modalOpen == false">
    <div ng-show="model.mode === 'edit'">
        {{'Organisaationmuokkaus.muokkaus'| i18n}}:
        <br>&nbsp;<br>
        <b>{{model.uriLocalizedNames["nimi"]}}</b>
        <br>&nbsp;<br>
        <div class="align-right ">
            <button type="button" class="btn" ng-click="cancel()"><i class="icon-arrow-left"></i></button>
            <button type="button" class="btn" ng-disabled="form.$invalid" ng-click="peruutaOrganisaationmuokkaus(form.$dirty)">{{'Organisaatiot.tarkastele'| i18n}}</button>
            <button type="button" ng-disabled="!form.$dirty || form.$invalid" auth="updateOrg" auth-service="APP_ORGANISAATIOHALLINTA" auth-org="{{model.organisaatio.oid}}" class="btn btn-primary" ng-click="save()">{{'Organisaationmuokkaus.tallenna'| i18n}}</button>
        </div>
        <br>&nbsp;
        <span class="muted"><em>{{model.savestatus}}</em></span>
    </div>
    <div ng-show="model.mode === 'new'">
        {{'Organisaationmuokkaus.uudenluonti'| i18n}}:
        <br>&nbsp;<br>
        <b>{{model.uriLocalizedNames["parentnimi"]}}</b>
        <br>&nbsp;<br>
        <div class="align-right ">
            <button type="button" class="btn" ng-click="cancel()"><i class="icon-arrow-left"></i></button>
            <button type="button" class="btn" ng-disabled="form.$invalid" ng-click="peruutaOrganisaationmuokkaus(form.$dirty)">{{'Organisaatiot.tarkastele'| i18n}}</button>
            <button type="button" ng-disabled="!form.$dirty || form.$invalid" auth="crudOrg" auth-service="APP_ORGANISAATIOHALLINTA" auth-org="{{model.organisaatio.parentOid}}" class="btn" ng-click="save()">{{'Organisaationmuokkaus.tallenna'| i18n}}</button>
        </div>
        <br>&nbsp;
        <span class="muted"><em>{{model.savestatus}}</em></span>
    </div>
    <p>
</div>