<form name="form" class="form-horizontal" novalidate>
    <div class="control-group" >
        <div class="controls">
            <div class="span10">
                <h3>
                    <span ng-show="model.mode === 'edit'">{{'Organisaationmuokkaus.muokkaus'| i18n}} {{model.uriLocalizedNames["nimi"]}}</span>
                    <span ng-show="model.mode === 'new'">{{'Organisaationmuokkaus.uudenluonti'| i18n}} {{model.uriLocalizedNames["parentnimi"]}}</span>
                </h3>
            </div>
        </div>
    </div>

    <div class="control-group">
        <label class="control-label">
            {{'Organisaationtarkastelu.organisaatiotyyppi'| i18n}}*
        </label>

        <div class="controls">
            <span ng-repeat="tyyppi in model.koodisto.organisaatiotyypit">
                <span ng-if="model.koodisto.ophOrganisaatiot.indexOf(tyyppi) > - 1">
                    <input class="" type='checkbox' name="orgtyyppi" ng-model='dummy_orgtyyppi'
                           auth="updateOph" auth-service="APP_ORGANISAATIOHALLINTA" auth-disable="true"
                           ng-checked="model.organisaatio.tyypit.indexOf(tyyppi) !== - 1"
                           ng-click="model.toggleCheckOrganisaatio(tyyppi);form.$dirty = true">
                    {{tyyppi| i18n}}
                </span>
                <span ng-if="(model.koodisto.ophOrganisaatiot.indexOf(tyyppi) === - 1)">
                    <input type='checkbox' name="orgtyyppi" ng-model='dummy_orgtyyppi'
                           ng-checked="model.organisaatio.tyypit.indexOf(tyyppi) !== - 1"
                           ng-click="model.toggleCheckOrganisaatio(tyyppi);form.$dirty = true">
                    {{tyyppi| i18n}}
                </span>
            </span>
            <!-- Näytetään tyypit, jotka eivät hierarkiasääntöjen mukaan ole valideja -->
            <span ng-repeat="tyyppi in model.organisaatio.tyypit">
                <span ng-if="model.koodisto.organisaatiotyypit.indexOf(tyyppi) === - 1">
                    <input class="" type='checkbox' name="orgtyyppi" ng-model='dummy_orgtyyppi'
                           ng-checked="model.organisaatio.tyypit.indexOf(tyyppi) !== - 1" disabled>
                    {{tyyppi| i18n}}
                </span>
            </span>
            <div ng-if="model.organisaatio.tyypit.length === 0">
                <input type="hidden" name="orgtyypit" ng-model="orgtyypit" required>
                <span class="text-error" ng-show="form.orgtyypit.$error.required">
                    {{'Organisaationtarkastelu.organisaatiotyyppi'| i18n}}
                    {{'Organisaationmuokkaus.validointi.pakollinen'| i18n}}
                </span>
            </div>
        </div>
    </div>
    <div class="control-group" ng-if="model.isKoulutustoimija()">
        <label class="control-label">
            {{'Organisaationtarkastelu.yritysmuoto'| i18n}}
        </label>
        <div class="controls">
            <input id="yritysmuoto" type="text" maxlength="255" name="yritysmuoto"
                   ng-model="model.organisaatio.yritysmuoto" oph-set-dirty="model.mode==='new'"
                   ie-placeholder placeholder="{{'Organisaationtarkastelu.yritysmuoto'| i18n}}" disabled/>
        </div>
    </div>

    <div class="control-group" ng-if="model.isKoulutustoimija()">
        <label class="control-label">
            {{'Organisaationtarkastelu.ytunnus'| i18n}}
        </label>
        <div class="controls">
            <input id="ytunnus" type="text" maxlength="9" name="ytunnus" oph-enter
                   auth="updateOph" auth-service="APP_ORGANISAATIOHALLINTA" auth-disable="true"
                   ng-model="model.organisaatio.ytunnus"
                   ie-placeholder placeholder="{{'Organisaationtarkastelu.ytunnus'| i18n}}" ng-pattern="/^\d{7}-./"/>
                    <button auth="crudOph" auth-service="APP_ORGANISAATIOHALLINTA" ng-if="model.isKoulutustoimija()" class="btn" ng-click="haeYtjTiedot(model.organisaatio.ytunnus)" tooltip="{{'Organisaatiot.ohje.haeytjtiedot' | i18n}}">
                        {{'Organisaationmuokkaus.paivitaYtj'| i18n}}
                    </button>
            <div>
                <span class="text-error" ng-show="form.ytunnus.$error.pattern">
                    {{'Organisaationmuokkaus.validointi.ytunnus'| i18n}}
                </span>
            </div>
        </div>
    </div>

    <div class="control-group" ng-if="model.isKoulutustoimija()">
        <label class="control-label">
            {{'Organisaationtarkastelu.virastotunnus'| i18n}}
        </label>
        <div class="controls">
            <input id="virastotunnus" type="text" maxlength="20" name="virastotunnus" oph-enter
                   auth="updateOph" auth-service="APP_ORGANISAATIOHALLINTA" auth-disable="true"
                   ng-model="model.organisaatio.virastoTunnus"
                   ie-placeholder placeholder="{{'Organisaationtarkastelu.virastotunnus'| i18n}}" ng-pattern="/^\d{6}.*/"/>
            <div>
                <span class="text-error" ng-show="form.virastotunnus.$error.pattern">
                    {{'Organisaationmuokkaus.validointi.virastotunnus'| i18n}}
                </span>
            </div>
        </div>
    </div>

    <div class="control-group" ng-if="model.isOppilaitos()">
        <label class="control-label">
            {{'Organisaationtarkastelu.oppilaitoskoodi'| i18n}}*
        </label>
        <div class="controls">
            <input id="oppilaitoskoodi" type="text" maxlength="20" name="oppilaitoskoodi"
                   auth="updateOph" auth-service="APP_ORGANISAATIOHALLINTA" auth-disable="true"
                   ng-model="model.organisaatio.oppilaitosKoodi"
                   ie-placeholder placeholder="{{'Organisaationtarkastelu.oppilaitoskoodi'| i18n}}" required ng-pattern="/^\d{5}$/"/>
            <div>
                <span class="text-error" ng-show="form.oppilaitoskoodi.$error.required">
                    {{'Organisaationtarkastelu.oppilaitoskoodi'| i18n}}
                    {{'Organisaationmuokkaus.validointi.pakollinen'| i18n}}
                </span>
                <span class="text-error" ng-show="form.oppilaitoskoodi.$error.pattern">
                    {{'Organisaationmuokkaus.validointi.oppilaitoskoodi'| i18n}}
                </span>
            </div>
        </div>
    </div>

    <div class="control-group" ng-if="model.isOppilaitos()">
        <label class="control-label">
            {{'Organisaationtarkastelu.oppilaitostyyppi'| i18n}}*
        </label>
        <div class="controls">
            <select id="oppilaitostyyppi" ng-model="model.organisaatio.oppilaitosTyyppiUri" class="span6"
                    auth="updateOph" auth-service="APP_ORGANISAATIOHALLINTA" auth-disable="true"
                    ng-options="olTyyppi.uri as olTyyppi.nimi for olTyyppi in model.koodisto.oppilaitostyypit | orderBy:'nimi'"
                    ng-change="model.selectOppilaitosTyyppi(); form.$dirty = true" required>
                <option value="">{{'Organisaationmuokkaus.valitse'| i18n}}</option>
            </select>
            <div ng-if="!model.organisaatio.oppilaitosTyyppiUri">
                <input type="hidden" name="oltyyppivirhe" ng-model="oltyyppivirhe" required>
                <span class="text-error" ng-show="form.oltyyppivirhe.$error.required">
                    {{'Organisaationtarkastelu.oppilaitostyyppi'| i18n}}
                    {{'Organisaationmuokkaus.validointi.pakollinen'| i18n}}
                </span>
            </div>
        </div>
    </div>

    <div class="control-group" ng-if="model.hasVuosiluokat()">
        <label class="control-label">
            {{'Organisaationtarkastelu.vuosiluokat'| i18n}}
        </label>
        <div class="controls">
            <div ng-repeat="vl in model.koodisto.vuosiluokat| orderBy:'nimi'">
                <div>
                    <input type='checkbox' name="vuosiluokka"
                           ng-checked="model.organisaatio.vuosiluokat.indexOf(vl.uri) !== - 1"
                           ng-click="model.toggleCheckVuosiluokka(vl.uri);
                                       form.$dirty = true">{{model.uriLocalizedNames[vl.uri]}}
                </div>
            </div>
        </div>
    </div>

    <div class="control-group">
        <label class="control-label">
            {{'Organisaationtarkastelu.nimi'| i18n}}*
        </label>
        <div class="controls">
            <input ng-if="model.isKoulutustoimija() || model.isOppilaitos()"
                   type="text" name="nimifi" class="span6"
                   auth="updateOph" auth-service="APP_ORGANISAATIOHALLINTA" auth-disable="true"
                   ng-model="model.organisaatio.nimi.fi" oph-decode-name oph-enter
                   ie-placeholder placeholder="{{'Organisaationmuokkaus.nimisuomeksi'| i18n}}" ng-required="false" names-combined-field/>
            <input ng-if="model.isKoulutustoimija() === false && model.isOppilaitos() === false"
                   type="text" name="nimifi" class="span6"
                   ng-model="model.organisaatio.nimi.fi" oph-decode-name oph-enter
                   ie-placeholder placeholder="{{'Organisaationmuokkaus.nimisuomeksi'| i18n}}" ng-required="false" names-combined-field/>
            <div>
                <span class="text-error" ng-show="form.nimifi.$error.namescombinedrequired">
                    {{'Organisaationmuokkaus.ohje.nimet'| i18n}}
                </span>
            </div>
        </div>
    </div>

    <div class="control-group">
        <div class="controls">
            <input ng-if="model.isKoulutustoimija() || model.isOppilaitos()"
                   id="nimisv" type="text" name="nimisv" class="span6"
                   auth="updateOph" auth-service="APP_ORGANISAATIOHALLINTA" auth-disable="true"
                   ng-model="model.organisaatio.nimi.sv" oph-decode-name oph-enter
                   ie-placeholder placeholder="{{'Organisaationmuokkaus.nimiruotsiksi'| i18n}}" ng-required="false" names-combined-field/>
            <input ng-if="model.isKoulutustoimija() === false && model.isOppilaitos() === false"
                   id="nimisv" type="text" name="nimisv" class="span6"
                   ng-model="model.organisaatio.nimi.sv" oph-decode-name oph-enter
                   ie-placeholder placeholder="{{'Organisaationmuokkaus.nimiruotsiksi'| i18n}}" ng-required="false" names-combined-field/>
        </div>
    </div>
    <div class="control-group">
        <div class="controls">
            <input ng-if="model.isKoulutustoimija() || model.isOppilaitos()"
                   id="nimise" type="text" name="nimien" class="span6"
                   auth="updateOph" auth-service="APP_ORGANISAATIOHALLINTA" auth-disable="true"
                   ng-model="model.organisaatio.nimi.en" oph-decode-name oph-enter
                   ie-placeholder placeholder="{{'Organisaationmuokkaus.nimienglanniksi'| i18n}}" ng-required="false" names-combined-field/>
            <input ng-if="model.isKoulutustoimija() === false && model.isOppilaitos() === false"
                   id="nimise" type="text" name="nimien" class="span6"
                   ng-model="model.organisaatio.nimi.en" oph-decode-name oph-enter
                   ie-placeholder placeholder="{{'Organisaationmuokkaus.nimienglanniksi'| i18n}}" ng-required="false" names-combined-field/>
        </div>
    </div>

    <div class="control-group">
        <label class="control-label">
            {{'Organisaationtarkastelu.voimassaolo'| i18n}}*
        </label>
        <div class="controls">
            <div>
                <input ng-if="model.isKoulutustoimija() || model.isOppilaitos()" oph-enter
                       auth="updateOph" auth-service="APP_ORGANISAATIOHALLINTA" auth-disable="true"
                       type="text" name="luontipvm" formatteddate datepicker-popup="dd.MM.yyyy" min="'1990-01-01'" max="'2030-12-31'" ng-model="model.organisaatio.alkuPvm"
                       close-on-date-selection="true" ie-placeholder placeholder="{{'Organisaationmuokkaus.luontipvm'| i18n}}"
                       close-text="{{'Organisaationmuokkaus.sulje'| i18n}}"
                       current-text="{{'Organisaationmuokkaus.tanaan'| i18n}}"
                       clear-text="{{'Organisaationmuokkaus.tyhjenna'| i18n}}"
                       toggle-weeks-text="{{'Organisaationmuokkaus.viikkonumerot'| i18n}}" required/>
                <input ng-if="model.isKoulutustoimija() === false && model.isOppilaitos() === false" oph-enter
                       type="text" name="luontipvm" formatteddate datepicker-popup="dd.MM.yyyy" min="'1990-01-01'" max="'2030-12-31'" ng-model="model.organisaatio.alkuPvm"
                       close-on-date-selection="true" ie-placeholder placeholder="{{'Organisaationmuokkaus.luontipvm'| i18n}}"
                       close-text="{{'Organisaationmuokkaus.sulje'| i18n}}"
                       current-text="{{'Organisaationmuokkaus.tanaan'| i18n}}"
                       clear-text="{{'Organisaationmuokkaus.tyhjenna'| i18n}}"
                       toggle-weeks-text="{{'Organisaationmuokkaus.viikkonumerot'| i18n}}" required/>
                &nbsp;-&nbsp;
                <input ng-if="model.isKoulutustoimija() || model.isOppilaitos()"
                       auth="updateOph" auth-service="APP_ORGANISAATIOHALLINTA" auth-disable="true" oph-enter
                       type="text" name="lakkautuspvm" formatteddate datepicker-popup="dd.MM.yyyy" min="'1990-01-01'" max="'2030-12-31'" ng-model="model.organisaatio.lakkautusPvm"
                       close-on-date-selection="true" ie-placeholder placeholder="{{'Organisaationmuokkaus.lakkautuspvm'| i18n}}"
                       close-text="{{'Organisaationmuokkaus.sulje'| i18n}}"
                       current-text="{{'Organisaationmuokkaus.tanaan'| i18n}}"
                       clear-text="{{'Organisaationmuokkaus.tyhjenna'| i18n}}"
                       toggle-weeks-text="{{'Organisaationmuokkaus.viikkonumerot'| i18n}}" />
                <input ng-if="model.isKoulutustoimija() === false && model.isOppilaitos() === false" oph-enter
                       type="text" name="lakkautuspvm" formatteddate datepicker-popup="dd.MM.yyyy" min="'1990-01-01'" max="'2030-12-31'" ng-model="model.organisaatio.lakkautusPvm"
                       close-on-date-selection="true" ie-placeholder placeholder="{{'Organisaationmuokkaus.lakkautuspvm'| i18n}}"
                       close-text="{{'Organisaationmuokkaus.sulje'| i18n}}"
                       current-text="{{'Organisaationmuokkaus.tanaan'| i18n}}"
                       clear-text="{{'Organisaationmuokkaus.tyhjenna'| i18n}}"
                       toggle-weeks-text="{{'Organisaationmuokkaus.viikkonumerot'| i18n}}" />
            </div>
            <div>
                <em class="muted">{{'Organisaationmuokkaus.ohje.alkupvm'| i18n}}</em>
            </div>
            <div>
                <span class="text-error" ng-show="form.luontipvm.$error.required || form.luontipvm.$error.date">
                    {{'Organisaationmuokkaus.validointi.alkupvm'| i18n}}. </span>
                <span class="text-error" ng-show="form.lakkautuspvm.$error.date">
                    {{'Organisaationmuokkaus.validointi.loppupvm'| i18n}}</span>
                <span class="text-error" ng-show="form.luontipvm.$error.dateYear">
                    {{'Organisaationmuokkaus.validointi.alkupvmvuosi'| i18n}}. </span>
                <span class="text-error" ng-show="form.lakkautuspvm.$error.dateYear">
                    {{'Organisaationmuokkaus.validointi.loppupvmvuosi'| i18n}}</span>
            </div>
        </div>
    </div>

    <div class="control-group">
        <label class="control-label">
            {{'Organisaationtarkastelu.kotipaikka'| i18n}}*
        </label>
        <div class="controls">
            <select id="kotipaikka" ng-model="model.organisaatio.kotipaikkaUri" class="span6"
                    ng-options="kp.uri as kp.nimi for kp in model.koodisto.kotipaikat | orderBy:'nimi'" required>
                <option value="">{{'Organisaationmuokkaus.valitse'| i18n}}</option>
            </select>
            <div ng-if="!model.organisaatio.kotipaikkaUri">
                <input type="hidden" name="kotipaikkavirhe" ng-model="kotipaikkavirhe" required>
                <span class="text-error" ng-show="form.kotipaikkavirhe.$error.required">
                    {{'Organisaationtarkastelu.kotipaikka'| i18n}}
                    {{'Organisaationmuokkaus.validointi.pakollinen'| i18n}}
                </span>
            </div>
        </div>
    </div>

    <div class="control-group">
        <label class="control-label">
            {{'Organisaationtarkastelu.maa'| i18n}}*
        </label>
        <div class="controls">
            <select id="maa" ng-model="model.organisaatio.maaUri"
                    ng-options="maa.uri as maa.nimi for maa in model.koodisto.maat | orderBy:'nimi'" required>
                <option value="">{{'Organisaationmuokkaus.valitse'| i18n}}</option>
            </select>
            <div>
                <em class="muted">{{'Organisaationmuokkaus.ohje.maa'| i18n}}</em>
            </div>
            <div ng-if="!model.organisaatio.maaUri">
                <input type="hidden" name="maavirhe" ng-model="maavirhe" required>
                <span class="text-error" ng-show="form.maavirhe.$error.required">
                    {{'Organisaationtarkastelu.maa'| i18n}}
                    {{'Organisaationmuokkaus.validointi.pakollinen'| i18n}}
                </span>
            </div>
        </div>
    </div>

    <div class="control-group">
        <label class="control-label">
            {{'Organisaationtarkastelu.kieli'| i18n}}*
        </label>
        <div class="controls">
            <span ng-repeat="kieli in model.organisaatio.kieletUris">
                <button type="button" class="btn btn-small" ng-click="model.removeLang(kieli);
                            form.$dirty = true">{{model.uriLocalizedNames[kieli]}}&nbsp;<i class="icon-remove"></i></button>
            </span>
            <select id="maa" ng-model="model.koodisto.kieliplaceholder"
                    ng-options="kieli.uri as kieli.nimi for kieli in model.koodisto.opetuskielet | orderBy:'nimi'" ng-required="false"
                    ng-click="model.addLang()">
                <option value="">{{'Organisaationmuokkaus.lisaakieli'| i18n}}</option>
            </select>
            <div ng-if="model.organisaatio.kieletUris.length === 0">
                <input type="hidden" name="kielivirhe" ng-model="kielivirhe" required>
                <span class="text-error" ng-show="form.kielivirhe.$error.required">
                    {{'Organisaationtarkastelu.kieli'| i18n}}
                    {{'Organisaationmuokkaus.validointi.pakollinen'| i18n}}
                </span>
            </div>
        </div>
    </div>

    <div class="control-group">
        <label class="control-label">
            {{'Organisaationtarkastelu.kuva'| i18n}}
        </label>
        <div class="controls">
            <div ng-show="model.organisaatio.metadata.kuvaEncoded">
                <img ng-src="data:image/jpeg;base64, {{model.organisaatio.metadata.kuvaEncoded}}">
                <div>&nbsp;</div>
            </div>
            <div ng-controller="UploadController">
                <label ng-show="model.organisaatio.metadata.kuvaEncoded" for="upload" class="btn" style="text-align: center">{{ 'Organisaationmuokkaus.vaihdakuva' | i18n}}</label>
                <label ng-hide="model.organisaatio.metadata.kuvaEncoded" for="upload" class="btn" style="text-align: center">{{ 'Organisaationmuokkaus.lisaakuva' | i18n}}</label>
                <input style="display: none;" ng-if="canUseFileReader" type="file" name="upload" id="upload" ng-model="model.imagefile" ng-file-select="onFileSelect($files)">
                <input style="display: none;" ng-if="!canUseFileReader" id="upload" type="file" name="upload" data-url="" oph-fileupload>
                <button ng-show="model.organisaatio.metadata.kuvaEncoded" type="button" class="btn" ng-click="form.$setDirty(); model.removeImage(form)">{{ 'Organisaationmuokkaus.poistakuva' | i18n}}</button>
            </div>
        </div>
    </div>

    <hr>

    <!-- YHTEYSTIEDOT --->

    <div class="row">
        <div class="span4">
            <div class="view-row-label">
                <a href="" ng-model="ytexpanded" ng-click="ytexpanded = !ytexpanded">
                    <label>
                        <span ng-class="{'icon-chevron-down':ytexpanded, 'icon-chevron-right':!ytexpanded}"></span> {{'Organisaationmuokkaus.yhteystiedot'| i18n}}
                    </label>
                </a>
            </div>
            <span class="text-error span4" ng-show="form.yhteystiedot.$invalid">
                {{'Organisaationmuokkaus.validation.osio'| i18n}}<br>
            </span>
        </div>
    </div>

    <div ng-show="ytexpanded" ng-form="yhteystiedot">

        <tabset>
            <tab ng-repeat="yttab in model.yttabs"
                 heading="{{model.uriLocalizedNames[yttab]}}"
                 select="model.ytlang=yttab">
            </tab>
        </tabset>

        <div class="control-group">
            <label class="control-label">
                {{'Organisaationmuokkaus.osoitemuoto'| i18n}}
            </label>
            <div class="controls">
                <select id="ytosoitemuoto" name="ytosoitemuoto" ng-model="model.osoitemuoto.yt[model.ytlang]">
                    <option value='suomalainen'>{{'Organisaationmuokkaus.suomalainenosoitemuoto'| i18n}}</option>
                    <option value='kansainvalinen'>{{'Organisaationmuokkaus.kansainvalinenosoitemuoto'| i18n}}</option>
                </select>
                <div><em class="muted">{{'Organisaationmuokkaus.ohje.osoitteentallennus'| i18n}}</em></div>
            </div>
        </div>
        <div class="control-group">
            <label class="control-label">
                {{'Organisaationtarkastelu.kayntiosoite'| i18n}}
            </label>
            <div class="controls" ng-show="model.osoitemuoto.yt[model.ytlang] === 'suomalainen'">
                <input id="kayntiosoitefi" type="text" maxlength="100" name="kayntiosoitefi" class="span6" oph-null-if-zero-length oph-enter
                       ng-model="model.yhteystiedot[model.ytlang].kaynti.osoite" ng-change="model.copyAddress(false, true)"
                       ng-minlength="3" ng-maxlength="100" oph-decode-name
                       ie-placeholder placeholder="{{'Organisaationmuokkaus.osoite'| i18n}}"/>
                &nbsp;&nbsp;&nbsp;
                <input id="kayntipostifi" name="kayntipostifi" type="text" oph-validate-postcode="yt" oph-null-if-zero-length oph-enter
                       ng-model="model.yhteystiedot.postinumerot[model.ytlang].kaynti" class="span2"
                       typeahead="nro for nro in model.koodisto.postinumerot | filter:$viewValue | limitTo:10"
                       ie-placeholder placeholder="{{'Organisaationmuokkaus.postinumero'| i18n}}" typeahead-editable="true"
                       ng-blur="model.setPostinumero(false, model.yhteystiedot[model.ytlang].kaynti, model.yhteystiedot.postinumerot[model.ytlang].kaynti)">
                &nbsp;{{model.getLocalizedPaikka(model.yhteystiedot.postinumerot[model.ytlang].kaynti, model.ytlang)}}
                <div>
                    <span class="text-error" ng-show="yhteystiedot.kayntiosoitefi.$error.minlength || yhteystiedot.kayntiosoitefi.$error.maxlength">
                        {{'Organisaationmuokkaus.validointi.osoitevirheellinen'| i18n}}
                    </span>
                </div>
                <div>
                    <span class="text-error" ng-show="yhteystiedot.kayntipostifi.$error.ophpostcode">
                        {{'Organisaationmuokkaus.validointi.postinumerovirheellinen'| i18n}}
                    </span>
                </div>
            </div>
            <div class="controls" ng-show="model.osoitemuoto.yt[model.ytlang] !== 'suomalainen'">
                <textarea id="kvkayntiosoitefi" name="kvkayntiosoitefi" rows="6" oph-null-if-zero-length
                          ng-model="model.yhteystiedot[model.ytlang].ulkomainen_kaynti.osoite" oph-decode-name
                          ng-disabled="disabled" ng-change="model.copyAddress(false, false)" class="span6"></textarea>
            </div>
        </div>
        <div class="control-group">
            <label class="control-label">
                {{'Organisaationtarkastelu.postiosoite'| i18n}}
            </label>
            <div class="controls" ng-show="model.osoitemuoto.yt[model.ytlang] === 'suomalainen'">
                <input id="postiosoitefi" type="text" maxlength="100" name="postiosoitefi" class="span6" oph-null-if-zero-length oph-enter
                       ng-model="model.yhteystiedot[model.ytlang].posti.osoite"
                       ng-disabled="model.osoitemuoto.ytsamaosoite[model.ytlang] === true"
                       ng-required="true"
                       ng-minlength="3" ng-maxlength="100" oph-decode-name
                       ie-placeholder placeholder="{{'Organisaationmuokkaus.osoite'| i18n}}"/>
                &nbsp;&nbsp;&nbsp;
                <input id="postipostifi" name="postipostifi" type="text" oph-validate-postcode="yt" oph-null-if-zero-length oph-enter
                       ng-model="model.yhteystiedot.postinumerot[model.ytlang].posti" class="span2"
                       ng-disabled="model.osoitemuoto.ytsamaosoite[model.ytlang] === true"
                       typeahead="nro for nro in model.koodisto.postinumerot | filter:$viewValue | limitTo:10"
                       ie-placeholder placeholder="{{'Organisaationmuokkaus.postinumero'| i18n}}" typeahead-editable="true"
                       ng-required="model.yhteystiedot[model.ytlang].posti.osoite"
                       ng-blur="model.setPostinumero(false, model.yhteystiedot[model.ytlang].posti, model.yhteystiedot.postinumerot[model.ytlang].posti)">
                &nbsp;{{model.getLocalizedPaikka(model.yhteystiedot.postinumerot[model.ytlang].posti, model.ytlang)}}
                <div>
                    <span class="text-error" ng-show="yhteystiedot.postiosoitefi.$error.minlength || yhteystiedot.postiosoitefi.$error.maxlength">
                        {{'Organisaationmuokkaus.validointi.osoitevirheellinen'| i18n}}
                    </span>
                </div>
                <div>
                    <span class="text-error" ng-show="yhteystiedot.postipostifi.$error.ophpostcode">
                        {{'Organisaationmuokkaus.validointi.postinumerovirheellinen'| i18n}}
                    </span>
                </div>
                <div>
                    <span class="text-error" ng-show="yhteystiedot.postipostifi.$error.required">
                        {{'Organisaationmuokkaus.postinumero' | i18n}} {{'Organisaationmuokkaus.validointi.pakollinen' | i18n}}
                    </span>
                </div>
                <div>
                    <span class="text-error" ng-show="yhteystiedot.postiosoitefi.$error.required">
                        {{'Organisaationmuokkaus.postiosoite' | i18n}} {{'Organisaationmuokkaus.validointi.pakollinen' | i18n}}
                    </span>
                </div>
                <!-- <div>
                    <input type='checkbox' ng-model="model.osoitemuoto.ytsamaosoite[model.ytlang]"
                           ng-change="model.copyAddress(false, true)"/>{{'Organisaationmuokkaus.samaosoite'| i18n}}
                </div> -->
            </div>
            <div class="controls" ng-if="model.osoitemuoto.yt[model.ytlang] !== 'suomalainen'">
                <textarea id="kvpostiosoitefi" name="kvpostiosoitefi" rows="6" oph-null-if-zero-length
                          ng-model="model.yhteystiedot[model.ytlang].ulkomainen_posti.osoite" oph-decode-name
                          ng-disabled="model.osoitemuoto.ytsamaosoite[model.ytlang] === true" class="span6"></textarea>
                <div>
                    <input type='checkbox' ng-model="model.osoitemuoto.ytsamaosoite[model.ytlang]"
                           ng-change="model.copyAddress(false, false)"/>{{'Organisaationmuokkaus.samaosoite'| i18n}}
                </div>
            </div>
        </div>

        <div class="control-group">
            <label class="control-label">
                {{'Organisaationtarkastelu.puhelinnumero'| i18n}}
            </label>
            <div class="controls">
                <input id="puhelinnumero" type="text" name="puhelinnumero"
                       ng-model="model.yhteystiedot[model.ytlang].puhelin.numero" oph-null-if-zero-length oph-enter
                       ie-placeholder placeholder="{{'Organisaationtarkastelu.puhelinnumero'| i18n}}" ng-pattern="/^[\d \-\+]+$/"/>
                <div>
                    <span class="text-error" ng-show="yhteystiedot.puhelinnumero.$error.pattern">
                        {{'Organisaationtarkastelu.puhelinnumero'| i18n}}
                        {{'Organisaationmuokkaus.validointi.virheellinen'| i18n}}
                    </span>
                </div>
            </div>
        </div>

        <div class="control-group">
            <label class="control-label">
                {{'Organisaationtarkastelu.faksinumero'| i18n}}
            </label>
            <div class="controls">
                <input id="faksinumero" type="text" maxlength="20" name="faksinumero"
                       ng-model="model.yhteystiedot[model.ytlang].faksi.numero" oph-null-if-zero-length oph-enter
                       ie-placeholder placeholder="{{'Organisaationtarkastelu.faksinumero'| i18n}}" ng-pattern="/^[\d \-\+]+$/"/>
                <div>
                    <span class="text-error" ng-show="yhteystiedot.faksinumero.$error.pattern">
                        {{'Organisaationtarkastelu.faksinumero'| i18n}}
                        {{'Organisaationmuokkaus.validointi.virheellinen'| i18n}}
                    </span>
                </div>
            </div>
        </div>

        <div class="control-group">
            <label class="control-label">
                {{'Organisaationtarkastelu.sahkopostiosoite'| i18n}}
            </label>
            <div class="controls">
                <input id="sahkopostiosoite" type="email" name="sahkopostiosoite" class="span6" maxlength="255"
                       ng-model="model.yhteystiedot[model.ytlang].email.email" oph-null-if-zero-length oph-enter
                       ie-placeholder placeholder="{{'Organisaationtarkastelu.sahkopostiosoite'| i18n}}"/>
                <div>
                    <span class="text-error" ng-show="yhteystiedot.sahkopostiosoite.$error.email">
                        {{'Organisaationtarkastelu.sahkopostiosoite'| i18n}}
                        {{'Organisaationmuokkaus.validointi.virheellinen'| i18n}}
                    </span>
                </div>
            </div>
        </div>

        <div class="control-group">
            <label class="control-label">
                {{'Organisaationtarkastelu.wwwosoite'| i18n}}
            </label>
            <div class="controls">
                <input id="wwwosoite" type="text" name="wwwosoite" class="span6" maxlength="255"
                       ng-model="model.yhteystiedot[model.ytlang].www.www" oph-null-if-zero-length oph-enter
                       ie-placeholder placeholder="{{'Organisaationtarkastelu.wwwosoite'| i18n}}" ng-required="false" codes-combined-field/>
                <div>
                    <span class="text-error" ng-show="yhteystiedot.wwwosoite.$error.codescombinedrequired">
                        {{'codes.validation.codescombinedrequired'| i18n}}</span>
                </div>
            </div>
        </div>

        <hr>
    </div> <!-- ytexpanded -->

    <!-- LISÄYHTEYSTIEDOT -->

    <div ng-repeat="(ytoid, langs) in model.lisayhteystiedot" ng-init="ltexpanded = {};">
        <div class="row">
            <div class="span4">
                <div class="view-row-label">
                    <a href="" ng-model="ltexpanded[ytoid]" ng-click="ltexpanded[ytoid] = !ltexpanded[ytoid]">
                        <label>
                            <span ng-class="{'icon-chevron-down':ltexpanded[ytoid], 'icon-chevron-right':!ltexpanded[ytoid]}"></span> {{model.uriLocalizedNames[ytoid]}}
                        </label>
                    </a>
                </div>
                <span class="text-error span4" ng-show="form['lisayhteystiedotForm_' + ytoid].$invalid">
                    {{'Organisaationmuokkaus.validation.osio'| i18n}}<br>
                </span>
            </div>
        </div>

        <div ng-show="ltexpanded[ytoid]" ng-init="model.ltlang = {}" ng-form dynamic-name-prefix='lisayhteystiedotForm' dynamic-name="ytoid">
            <tabset>
                <tab ng-repeat="lttab in model.lttabs"
                     heading="{{model.uriLocalizedNames[lttab]}}"
                     select="model.ltlang[ytoid]=lttab">
                </tab>
            </tabset>
            <div class="control-group" ng-repeat="yt in model.lisayhteystiedot[ytoid][model.ltlang[ytoid]]" ng-form="ytForm">
                <label class="control-label">
                    {{model.uriLocalizedNames[yt['YhteystietoElementti.oid']]}}{{yt["YhteystietoElementti.pakollinen"] && yt["YhteystietoElementti.pakollinen"]!=="false"?"*":""}}
                </label>
                <div class="controls">
                    <input type="text" dynamic-name="yt['YhteystietoElementti.oid']" dynamic-name-prefix="name" class="span6" oph-null-if-zero-length oph-enter
                           ng-model="yt['YhteystietoArvo.arvoText']" ng-required="yt['YhteystietoElementti.pakollinen'] && yt['YhteystietoElementti.pakollinen']!=='false'">
                    <div>
                        <span class="text-error" ng-show="ytForm['name_'+ yt['YhteystietoElementti.oid']].$error.required">
                            {{model.uriLocalizedNames[yt['YhteystietoElementti.oid']]}}
                            {{'Organisaationmuokkaus.validointi.pakollinen'| i18n}}
                        </span>
                    </div>

                </div>
            </div>
        </div> <!-- ltexpanded -->
    </div>

    <!-- HAKIJAPALVELUT --->

    <div class="row">
        <div class="span4">
            <div class="view-row-label">
                <a href="" ng-model="hpexpanded" ng-click="hpexpanded = !hpexpanded">
                    <label>
                        <span ng-class="{'icon-chevron-down':hpexpanded, 'icon-chevron-right':!hpexpanded}"></span> {{'Organisaationmuokkaus.hakijapalvelut'| i18n}}
                    </label>
                </a>
                <span class="text-error span4" ng-show="form.hakijapalvelut.$invalid">
                    {{'Organisaationmuokkaus.validation.osio'| i18n}}<br>
                </span>
            </div>
        </div>
    </div>

    <div ng-show="hpexpanded" ng-form="hakijapalvelut">
        <tabset>
            <tab select="model.hplang='+'">
                <tab-heading>
                    <span class="icon-plus-sign"></span>
                </tab-heading>
            </tab>
            <tab ng-repeat="tab in model.mkSections.hp.tabs"
                 active="tab.active"
                 select="model.hplang=tab.lang">
                <tab-heading>
                    {{model.uriLocalizedNames[tab.lang]}} <a ng-click="model.removeMkLang('hp', $index)" href=''><span class='icon-remove'>&nbsp;</span></a>
                </tab-heading>
            </tab>
        </tabset>
        <div ng-if="model.hplang === '+'">
            <div class="control-group">
                <select id="maa" ng-model="model.mkSections.hp.placeholder"
                        ng-options="kieli.uri as kieli.nimi for kieli in model.koodisto.isokielet | orderBy:'nimi'" ng-required="false"
                        ng-click="model.addMkLang('hp')">
                    <option value="">{{'Organisaationmuokkaus.lisaakieli'| i18n}}</option>
                </select>
            </div>
        </div>
        <div ng-show="model.hplang !== '+'" ng-repeat='tab in model.mkSections.hp.tabs'>
            <div ng-show='tab.lang === model.hplang'>
                <div class="control-group">
                    <label class="control-label">
                        {{'Organisaationtarkastelu.hakutoimistonnimi'| i18n}}
                    </label>

                    <div class="controls">
                        <input id="htnimifi" type="text" name="htnimifi" class="span6" oph-null-if-zero-length oph-enter
                               ng-model="model.organisaatio.metadata.hakutoimistonNimi[model.hplang]" oph-decode-name
                               ie-placeholder placeholder="{{'Organisaationtarkastelu.hakutoimistonnimi'| i18n}}"
                               ng-minlength="3" ng-maxlength="255"
                               ng-required="false"/>
                    </div>
                    <div>
                        <span class="text-error" ng-show="hakijapalvelut.nimi.$error.minlength || hakijapalvelut.nimi.$error.maxlength">
                            {{'Organisaationmuokkaus.validointi.osoitevirheellinen'| i18n}}
                        </span>
                    </div>
                </div>

                <div class="control-group">
                    <label class="control-label">
                        {{'Organisaationmuokkaus.osoitemuoto'| i18n}}
                    </label>
                    <div class="controls">
                        <select id="hposoitemuoto" name="hposoitemuoto" ng-model="model.osoitemuoto.hp[model.hplang]">
                            <option value='suomalainen'>{{'Organisaationmuokkaus.suomalainenosoitemuoto'| i18n}}</option>
                            <option value='kansainvalinen'>{{'Organisaationmuokkaus.kansainvalinenosoitemuoto'| i18n}}</option>
                        </select>
                        <div><em class="muted">{{'Organisaationmuokkaus.ohje.osoitteentallennus'| i18n}}</em></div>
                    </div>
                </div>

                <div class="control-group">
                    <label class="control-label">
                        {{'Organisaationtarkastelu.kayntiosoite'| i18n}}
                    </label>
                    <div class="controls" ng-show="model.osoitemuoto.hp[model.hplang] === 'suomalainen'">
                        <input id="mdkayntiosoitefi" type="text" maxlength="100" name="mdkayntiosoitefi" class="span6"
                               ie-placeholder placeholder="{{'Organisaationmuokkaus.osoite'| i18n}}" oph-null-if-zero-length oph-enter
                               ng-minlength="3" ng-maxlength="100" oph-decode-name
                               ng-model="model.mdyhteystiedot[model.hplang].kaynti.osoite" ng-change="model.copyAddress(true, true)"/>
                        &nbsp;&nbsp;&nbsp;
                        <input id="mdkayntipostifi" name="mdkayntipostifi" type="text" oph-validate-postcode="hp" oph-null-if-zero-length oph-enter
                               ng-model="model.mdyhteystiedot.postinumerot[model.hplang].kaynti" class="span2"
                               typeahead="nro for nro in model.koodisto.postinumerot | filter:$viewValue | limitTo:10"
                               ie-placeholder placeholder="{{'Organisaationmuokkaus.postinumero'| i18n}}" typeahead-editable="true"
                               ng-blur="model.setPostinumero(true, model.mdyhteystiedot[model.hplang].kaynti, model.mdyhteystiedot.postinumerot[model.hplang].kaynti)">
                        &nbsp;{{model.getLocalizedPaikka(model.mdyhteystiedot.postinumerot[model.hplang].kaynti, model.hplang)}}
                        <div>
                            <span class="text-error" ng-show="hakijapalvelut.mdkayntiosoitefi.$error.minlength || hakijapalvelut.mdkayntiosoitefi.$error.maxlength">
                                {{'Organisaationmuokkaus.validointi.osoitevirheellinen'| i18n}}
                            </span>
                        </div>
                        <div>
                            <span class="text-error" ng-show="hakijapalvelut.mdkayntipostifi.$error.ophpostcode">
                                {{'Organisaationmuokkaus.validointi.postinumerovirheellinen'| i18n}}
                            </span>
                        </div>
                    </div>
                    <div class="controls" ng-if="model.osoitemuoto.hp[model.hplang] !== 'suomalainen'">
                        <textarea id="mdkvkayntiosoitefi" name="mdkvkayntiosoitefi" rows="6" oph-null-if-zero-length
                                  ng-model="model.mdyhteystiedot[model.hplang].ulkomainen_kaynti.osoite" oph-decode-name
                                  ng-disabled="disabled" ng-change="model.copyAddress(true, false)" class="span6"></textarea>
                    </div>
                </div>
                <div class="control-group">
                    <label class="control-label">
                        {{'Organisaationtarkastelu.postiosoite'| i18n}}
                    </label>
                    <div class="controls" ng-show="model.osoitemuoto.hp[model.hplang] === 'suomalainen'">
                        <input id="mdpostiosoitefi" type="text" maxlength="100" name="mdpostiosoitefi" class="span6"
                               ie-placeholder placeholder="{{'Organisaationmuokkaus.osoite'| i18n}}" oph-null-if-zero-length oph-enter
                               ng-minlength="3" ng-maxlength="100" oph-decode-name
                               ng-model="model.mdyhteystiedot[model.hplang].posti.osoite" ng-disabled="model.osoitemuoto.hpsamaosoite[model.hplang] === true"/>
                        &nbsp;&nbsp;&nbsp;
                        <input id="mdpostipostifi" name="mdpostipostifi" type="text" oph-validate-postcode="hp" oph-null-if-zero-length oph-enter
                               ng-model="model.mdyhteystiedot.postinumerot[model.hplang].posti" class="span2"
                               ng-disabled="model.osoitemuoto.hpsamaosoite[model.hplang] === true"
                               typeahead="nro for nro in model.koodisto.postinumerot | filter:$viewValue | limitTo:10"
                               ie-placeholder placeholder="{{'Organisaationmuokkaus.postinumero'| i18n}}" typeahead-editable="true"
                               ng-required='model.mdyhteystiedot[model.hplang].posti.osoite'
                               ng-blur="model.setPostinumero(true, model.mdyhteystiedot[model.hplang].posti, model.mdyhteystiedot.postinumerot[model.hplang].posti)">
                        &nbsp;{{model.getLocalizedPaikka(model.mdyhteystiedot.postinumerot[model.hplang].posti, model.hplang)}}
                        <div>
                            <span class="text-error" ng-show="hakijapalvelut.mdpostiosoitefi.$error.minlength || hakijapalvelut.mdpostiosoitefi.$error.maxlength">
                                {{'Organisaationmuokkaus.validointi.osoitevirheellinen'| i18n}}
                            </span>
                        </div>
                        <div>
                            <span class="text-error" ng-show="hakijapalvelut.mdpostipostifi.$error.ophpostcode">
                                {{'Organisaationmuokkaus.validointi.postinumerovirheellinen'| i18n}}
                            </span>
                        </div>
                        <div>
                            <span class="text-error" ng-show="hakijapalvelut.mdpostipostifi.$error.required">
                                {{'Organisaationmuokkaus.postinumero' | i18n}} {{'Organisaationmuokkaus.validointi.pakollinen' | i18n}}
                            </span>
                        </div>
                        <div>
                            <input type='checkbox' ng-model="model.osoitemuoto.hpsamaosoite[model.hplang]"
                                   ng-change="model.copyAddress(true, true)"/>{{'Organisaationmuokkaus.samaosoite'| i18n}}
                        </div>
                    </div>
                    <div class="controls" ng-show="model.osoitemuoto.hp[model.hplang] !== 'suomalainen'">
                        <textarea id="mdkvpostiosoitefi" name="mdkvpostiosoitefi" rows="6" oph-null-if-zero-length
                                  ng-model="model.mdyhteystiedot[model.hplang].ulkomainen_posti.osoite" oph-decode-name
                                  ng-disabled="model.osoitemuoto.hpsamaosoite[model.hplang] === true" class="span6"></textarea>
                        <div>
                            <input type='checkbox' ng-model="model.osoitemuoto.hpsamaosoite[model.hplang]"
                                   ng-change="model.copyAddress(true, false)"/>{{'Organisaationmuokkaus.samaosoite'| i18n}}
                        </div>
                    </div>
                </div>

                <div class="control-group">
                    <label class="control-label">
                        {{'Organisaationtarkastelu.puhelinnumero'| i18n}}
                    </label>
                    <div class="controls">
                        <input id="mdpuhelinnumero" type="text" name="mdpuhelinnumero"
                               ng-model="model.mdyhteystiedot[model.hplang].puhelin.numero" oph-null-if-zero-length oph-enter
                               ie-placeholder placeholder="{{'Organisaationtarkastelu.puhelinnumero'| i18n}}" ng-pattern="/^[\d \-\+]+$/"/>
                        <div>
                            <span class="text-error" ng-show="hakijapalvelut.mdpuhelinnumero.$error.pattern">
                                {{'Organisaationtarkastelu.puhelinnumero'| i18n}}
                                {{'Organisaationmuokkaus.validointi.virheellinen'| i18n}}
                            </span>
                        </div>
                    </div>
                </div>

                <div class="control-group">
                    <label class="control-label">
                        {{'Organisaationtarkastelu.faksinumero'| i18n}}
                    </label>
                    <div class="controls">
                        <input id="mdfaksinumero" type="text" maxlength="20" name="mdfaksinumero"
                               ng-model="model.mdyhteystiedot[model.hplang].faksi.numero" oph-null-if-zero-length oph-enter
                               ie-placeholder placeholder="{{'Organisaationtarkastelu.faksinumero'| i18n}}" ng-pattern="/^[\d \-\+]+$/"/>
                        <div>
                            <span class="text-error" ng-show="hakijapalvelut.mdfaksinumero.$error.pattern">
                                {{'Organisaationtarkastelu.faksinumero'| i18n}}
                                {{'Organisaationmuokkaus.validointi.virheellinen'| i18n}}
                            </span>
                        </div>
                    </div>
                </div>

                <div class="control-group">
                    <label class="control-label">
                        {{'Organisaationtarkastelu.sahkopostiosoite'| i18n}}
                    </label>
                    <div class="controls">
                        <input id="mdsahkopostiosoite" type="email" name="mdsahkopostiosoite" class="span6" maxlength="255"
                               ng-model="model.mdyhteystiedot[model.hplang].email.email" oph-null-if-zero-length oph-enter
                               ie-placeholder placeholder="{{'Organisaationtarkastelu.sahkopostiosoite'| i18n}}"/>
                        <div>
                            <span class="text-error" ng-show="hakijapalvelut.mdsahkopostiosoite.$error.email">
                                {{'Organisaationtarkastelu.sahkopostiosoite'| i18n}}
                                {{'Organisaationmuokkaus.validointi.virheellinen'| i18n}}
                            </span>
                        </div>
                    </div>
                </div>

                <div class="control-group">
                    <label class="control-label">
                        {{'Organisaationtarkastelu.wwwosoite'| i18n}}
                    </label>
                    <div class="controls">
                        <input id="mdwwwosoite" type="text" name="mdwwwosoite" class="span6" maxlength="255"
                               ng-model="model.mdyhteystiedot[model.hplang].www.www" oph-null-if-zero-length oph-enter
                               ie-placeholder placeholder="{{'Organisaationtarkastelu.wwwosoite'| i18n}}" ng-required="false"/>
                        <div>
                            <span class="text-error" ng-show="hakijapalvelut.mdwwwosoite.$error.codescombinedrequired">
                                {{'codes.validation.codescombinedrequired'| i18n}}</span>
                        </div>
                    </div>
                </div>

            </div>
        </div>
        <hr>
    </div>

    <!-- ECTS-KOORDINAATTORI --->

    <div class="row">
        <div class="span4">
            <div>
                <a href="" ng-model="ectsexpanded" ng-click="ectsexpanded = !ectsexpanded">
                    <label>
                        <span ng-class="{'icon-chevron-down':ectsexpanded, 'icon-chevron-right':!ectsexpanded}"></span> {{'Organisaationtarkastelu.hakutoimistoectsnimi'| i18n}}
                    </label>
                </a>
            </div>
            <span class="text-error span4" ng-show="form.hakutoimistoectsnimi.$invalid">
                {{'Organisaationmuokkaus.validation.osio'| i18n}}<br>
            </span>
        </div>
    </div>

    <div ng-show="ectsexpanded" ng-form="hakutoimistoectsnimi">
        <div class="control-group">
            <label class="control-label">
                {{'Organisaationmuokkaus.hakutoimistoectsnimi'| i18n}}
            </label>
            <div class="controls">
                <input id="ectsnimi" name="ectsnimi" type="text" ng-model="model.organisaatio.metadata.hakutoimistoEctsNimi" class="span6"
                       typeahead="hlo.nimi for hlo in model.henkilot.virkailijat | filter:$viewValue | limitTo:10"
                       typeahead-on-select="model.setEctsNimi($item)" oph-enter>
            </div>
        </div>
        <div class="control-group">
            <label class="control-label">
                {{'Organisaationmuokkaus.hakutoimistoectstehtavanimike'| i18n}}
            </label>
            <div class="controls">
                <input id="ectsnimike" type="text" name="ectsnimike" class="span6"
                       ng-model="model.organisaatio.metadata.hakutoimistoEctsTehtavanimike"
                       ng-maxlength="255" oph-enter
                       ng-required="false"/>
                <div>
                    <span class="text-error" ng-show="hakutoimistoectsnimi.ectsnimike.$error.maxlength">
                        {{'Organisaationmuokkaus.validation.maxpituus255'| i18n}}
                    </span>
                </div>
            </div>
        </div>
        <div class="control-group">
            <label class="control-label">
                {{'Organisaationmuokkaus.hakutoimistoectspuhelin'| i18n}}
            </label>
            <div class="controls">
                <input id="ectspuhelin" type="text" name="ectspuhelin" oph-enter
                       ng-model="model.organisaatio.metadata.hakutoimistoEctsPuhelin"
                       ng-required="false" oph-null-if-zero-length oph-pattern="^[\d \-\+]*$"/>
                <div>
                    <span class="text-error" ng-show="hakutoimistoectsnimi.ectspuhelin.$error.ophPattern">
                        {{'Organisaationtarkastelu.puhelinnumero'| i18n}}
                        {{'Organisaationmuokkaus.validointi.virheellinen'| i18n}}
                    </span>
                </div>
            </div>
        </div>
        <div class="control-group">
            <label class="control-label">
                {{'Organisaationmuokkaus.hakutoimistoectsemail'| i18n}}
            </label>
            <div class="controls">
                <div>
                    <input id="ectsemail" type="email" name="ectsemail" class="span6" maxlength="255" oph-enter
                           ng-model="model.organisaatio.metadata.hakutoimistoEctsEmail"
                           ng-required="false" oph-null-if-zero-length/>
                    <span class="text-error" ng-show="hakutoimistoectsnimi.ectsemail.$error.email">
                        {{'Organisaationtarkastelu.sahkopostiosoite'| i18n}}
                        {{'Organisaationmuokkaus.validointi.virheellinen'| i18n}}
                    </span>
                </div>
            </div>
        </div>
        <hr>
    </div> <!-- ectsexpanded -->

    <!-- SOSIAALINEN MEDIA --->

    <div class="row">
        <div class="span4">
            <div>
                <a href="" ng-model="someexpanded" ng-click="someexpanded = !someexpanded">
                    <label>
                        <span ng-class="{'icon-chevron-down':someexpanded, 'icon-chevron-right':!someexpanded}"></span> {{'Organisaationtarkastelu.sosiaalinenmedia'| i18n}}
                    </label>
                </a>
            </div>
            <span class="text-error span4" ng-show="form.sosiaalinenmedia.$invalid">
                {{'Organisaationmuokkaus.validation.osio'| i18n}}<br>
            </span>
        </div>
    </div>

    <div ng-show="someexpanded" ng-form="sosiaalinenmedia">
        <tabset>
            <tab select="model.smlang='+'">
                <tab-heading>
                    <span class="icon-plus-sign"></span>
                </tab-heading>
            </tab>
            <tab ng-repeat="tab in model.mkSections.sm.tabs"
                 active="tab.active"
                 select="model.smlang=tab.lang">
                <tab-heading>
                    {{model.uriLocalizedNames[tab.lang]}} <a ng-click="model.removeMkLang('sm', $index)" href=''><span class='icon-remove'>&nbsp;</span></a>
                </tab-heading>
            </tab>
        </tabset>
        <div ng-if="model.smlang === '+'">
            <div class="control-group">
                <select id="maa" ng-model="model.mkSections.sm.placeholder"
                        ng-options="kieli.uri as kieli.nimi for kieli in model.koodisto.isokielet | orderBy:'nimi'" ng-required="false"
                        ng-click="model.addMkLang('sm')">
                    <option value="">{{'Organisaationmuokkaus.lisaakieli'| i18n}}</option>
                </select>
            </div>
        </div>
        <div ng-if="model.smlang !== '+'" ng-repeat='tab in model.mkSections.sm.tabs'>
            <div ng-if='tab.lang === model.smlang'>
                <div class="control-group">
                    <label class="control-label">
                        {{'Organisaationtarkastelu.sosiaalinenmedia'| i18n}}
                    </label>
                    <div class="controls">
                        <select id="some" ng-model="model.someplaceholder"
                                ng-options="some.type as some.nimi for some in model.some | orderBy:'some.nimi'" ng-required="false"
                                ng-click="model.addSome()">
                            <option value="">{{'Organisaationmuokkaus.lisaasosiaalinenmedia'| i18n}}</option>
                        </select>

                        <div class="control-group" ng-repeat="field in model.sometypes" ng-form="someForm"
                             ng-if="model.organisaatio.metadata.data[field].hasOwnProperty(model.smlang)">
                            <br />{{'Organisaationtarkastelu.' + field| i18n }}:<br />
                            <div class="input-append">
                                <input id="somein" type="text" name="somein" class="span6" oph-enter
                                       oph-pattern="{{model.someurls[field].validator}}"
                                       ng-model="model.organisaatio.metadata.data[field][model.smlang]"
                                       ie-placeholder placeholder="{{model.someurls[field].autofill}}" required>
                                <!--onclick="if (!value && placeholder) value = placeholder" -->
                                <button type="button" class="btn" ng-click="model.removeSome(field)"><i class="icon-remove"></i></button>
                            </div>
                            <div>
                                <span class="text-error" ng-show="someForm.somein.$error.ophPattern || someForm.somein.$error.required">
                                    {{'Organisaationmuokkaus.validation.some'| i18n}}</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <hr>
    </div> <!-- someexpanded -->


    <!-- ORGANISAATION ESITTELY --->

    <div class="row">
        <div class="span4">
            <div>
                <a href="" ng-model="oesexpanded" ng-click="oesexpanded = !oesexpanded">
                    <label>
                        <span ng-class="{'icon-chevron-down':oesexpanded, 'icon-chevron-right':!oesexpanded}"></span> {{'Organisaationtarkastelu.koulutustarjoajatiedot'| i18n}}
                    </label>
                </a>
            </div>
        </div>
    </div>

    <div ng-show="oesexpanded">

        <div class="control-group" ng-if="!model.isKoulutustoimija()">
            <div>
                <button type="button" class="btn" ng-click="vahvistakopiointi('kt')" tooltip="{{'Organisaationmuokkaus.ohje.kopioitiedot'| i18n}} {{model.uriLocalizedNames['parentnimi']}}."><i class="icon-copy"></i>{{'Organisaationmuokkaus.kopioitiedot'| i18n}}</button>
            </div>
        </div>

        <tabset>
            <tab select="model.ktlang='+'">
                <tab-heading>
                    <span class="dropdown">
                        <span class="icon-plus-sign dropdown-toggle"></span>
                        <ul ng-if="true" class="dropdown-menu" style="text-decoration: none">
                            <li
                                ng-repeat="kieli in model.koodisto.isokielet| orderBy:'nimi'">
                                <a href="" ng-click="model.mkSections.kt.placeholder = kieli.uri;
                                            model.addMkLang('kt')">{{kieli.nimi}}</a>
                            </li>
                        </ul>
                    </span>
                </tab-heading>
            </tab>
            <tab ng-repeat="tab in model.mkSections.kt.tabs"
                 active="tab.active"
                 select="model.ktlang=tab.lang">
                <tab-heading>
                    {{model.uriLocalizedNames[tab.lang]}} <a ng-click="model.removeMkLang('kt', $index)" href=''><span class='icon-remove'>&nbsp;</span></a>
                </tab-heading>
            </tab>
        </tabset>
        <div ng-if="model.ktlang === '+'">
            <div class="control-group">
                <select id="maa" ng-model="model.mkSections.kt.placeholder"
                        ng-options="kieli.uri as kieli.nimi for kieli in model.koodisto.isokielet | orderBy:'nimi'" ng-required="false"
                        ng-click="model.addMkLang('kt')">
                    <option value="">{{'Organisaationmuokkaus.lisaakieli'| i18n}}</option>
                </select>
            </div>
        </div>
        <div ng-if="model.ktlang !== '+'" ng-repeat='tab in model.mkSections.kt.tabs'>
            <div ng-if='tab.lang === model.ktlang'>

                <div class="control-group" ng-repeat="field in model.kttypes" ng-form="ktForm">
                    <label class="control-label">
                        {{'Organisaationtarkastelu.' + field| i18n}}
                    </label>
                    <div class="controls">
                        <em class="muted">{{'Organisaationmuokkaus.ohje.' + field| i18n}}</em>
                    </div>
                    <div class="controls">
                        <div class="well" tooltip="{{'Organisaationmuokkaus.ohje.aloitamuokkaus' | i18n }}" style="height:70px; overflow:auto" ng-click="openEditor(field, model.ktlang, model.getUserLang());" name="mcearea_kt" ng-bind-html="model.organisaatio.metadata.data[field][model.ktlang]"></div>
                        <div>
                            <span class="text-error" ng-show="model.organisaatio.metadata.data[field][model.ktlang] && model.organisaatio.metadata.data[field][model.ktlang].length > 16383">
                                {{'Organisaationmuokkaus.validation.maxpituusalku'| i18n }}
                                {{model.organisaatio.metadata.data[field][model.ktlang].length}}
                                {{'Organisaationmuokkaus.validation.maxpituusloppu'| i18n }}</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <hr>
    </div> <!-- oesexpanded -->

    <div class="view-row"></div>

    <!-- OPISKELIJAN EDUT -->

    <div class="row">
        <div class="span4">
            <div class="view-row-label">
                <a href="" ng-model="oeexpanded" ng-click="oeexpanded = !oeexpanded">
                    <label>
                        <span ng-class="{'icon-chevron-down':oeexpanded, 'icon-chevron-right':!oeexpanded}"></span> {{'Organisaationtarkastelu.opiskelijanedut'| i18n}}
                    </label>
                </a>
            </div>
        </div>
    </div>

    <div ng-show="oeexpanded">

        <div class="control-group">
        <div>
            <em class="muted">{{'Organisaationmuokkaus.ohje.palvelutoppijalle'| i18n}}</em>
        </div>

        <div ng-if="!model.isKoulutustoimija()">
            <button type="button" class="btn" ng-click="vahvistakopiointi('oe')" tooltip="{{'Organisaationmuokkaus.ohje.kopioitiedot'| i18n}} {{model.uriLocalizedNames['parentnimi']}}."><i class="icon-copy"></i>{{'Organisaationmuokkaus.kopioitiedot'| i18n}}</button>
        </div>

        </div>

        <tabset>
            <tab select="model.oelang='+'">
                <tab-heading>
                    <span class="dropdown">
                        <span class="icon-plus-sign dropdown-toggle"></span>
                        <ul ng-if="true" class="dropdown-menu" style="text-decoration: none">
                            <li
                                ng-repeat="kieli in model.koodisto.isokielet| orderBy:'nimi'">
                                <a href="" ng-click="model.mkSections.oe.placeholder = kieli.uri;
                                            model.addMkLang('oe')">{{kieli.nimi}}</a>
                            </li>
                        </ul>
                    </span>
                </tab-heading>
            </tab>
            <tab ng-repeat="tab in model.mkSections.oe.tabs"
                 active="tab.active"
                 select="model.oelang=tab.lang">
                <tab-heading>
                    {{model.uriLocalizedNames[tab.lang]}} <a ng-click="model.removeMkLang('oe', $index)" href=''><span class='icon-remove'>&nbsp;</span></a>
                </tab-heading>
            </tab>
        </tabset>

        <div ng-if="model.oelang === '+'">
            <div class="control-group">
                <select id="maa" ng-model="model.mkSections.oe.placeholder"
                        ng-options="kieli.uri as kieli.nimi for kieli in model.koodisto.isokielet | orderBy:'nimi'" ng-required="false"
                        ng-click="model.addMkLang('oe')">
                    <option value="">{{'Organisaationmuokkaus.lisaakieli'| i18n}}</option>
                </select>
            </div>
        </div>

        <div ng-if="model.oelang !== '+'" ng-repeat='tab in model.mkSections.oe.tabs'>
            <div ng-if='tab.lang === model.oelang'>

                <div class="control-group" ng-repeat="field in model.oetypes" ng-form="oeForm">
                    <label class="control-label">
                        {{'Organisaationtarkastelu.' + field| i18n}}
                    </label>
                    <div class="controls">
                        <em class="muted">{{'Organisaationmuokkaus.ohje.' + field| i18n}}</em>
                    </div>
                    <div class="controls">
                        <div class="well" tooltip="{{'Organisaationmuokkaus.ohje.aloitamuokkaus' | i18n }}" style="height:70px; overflow:auto" ng-click="openEditor(field, model.oelang, model.getUserLang());" name="mcearea_oe" ng-bind-html="model.organisaatio.metadata.data[field][model.oelang]"></div>
                        <div>
                            <span class="text-error" ng-show="model.organisaatio.metadata.data[field][model.oelang] && model.organisaatio.metadata.data[field][model.oelang].length > 16383">
                                {{'Organisaationmuokkaus.validation.maxpituusalku'| i18n }}
                                {{model.organisaatio.metadata.data[field][model.oelang].length}}
                                {{'Organisaationmuokkaus.validation.maxpituusloppu'| i18n }}</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <hr>
    </div> <!-- oeexpanded -->



    <div class="row">&nbsp;</div>
    <div class="row">&nbsp;</div>
</form>
<!-- Fixed footer ei näytä hyvältä virkailija framessa...
<div class="view-row fixed-footer" ng-show="model.organisaatio.nimi">
    <hr>
    <br>
    <div class="align-right margin-right-10">
        <button type="button" class="button small" ng-click="cancel()">{{'Organisaationmuokkaus.peruuta'| i18n}}</button>
        <button type="button" class="button small" ng-click="save()">{{'Organisaationmuokkaus.tallenna'| i18n}}</button>
    </div>
    <p>
</div>
-->

<div class="row fixed-footer" ng-if="modalOpen == false">
    <div ng-show="model.mode === 'edit'">
        <div class="align-right ">
            <button type="button" class="btn" ng-click="cancel()" tooltip="{{'Organisaatiot.ohje.palaahakuun' | i18n}}"><i class="icon-arrow-left"></i></button>
            <button type="button" class="btn" ng-disabled="form.$invalid" ng-click="peruutaOrganisaationmuokkaus(form.$dirty)">{{'Organisaatiot.tarkastele'| i18n}}</button>
            <button type="button" ng-disabled="!form.$dirty || form.$invalid" auth="updateOrg" auth-service="APP_ORGANISAATIOHALLINTA" auth-org="{{model.organisaatio.oid}}" class="btn btn-primary" ng-click="save()">{{'Organisaationmuokkaus.tallenna'| i18n}}</button>
        </div>
        <span ng-if="!form.$invalid" class="muted" style="background-color: #fff"><em>{{model.savestatus}}</em></span>
        <span ng-if="form.$invalid" class="muted" style="background-color: #fff; color: #f00"><em ng-mouseenter="listErrors()" tooltip-html-unsafe='{{model.errorsTooltip}}'>{{'Organisaationmuokkaus.validation.lomake'| i18n }}</em></span>
    </div>
    <div ng-show="model.mode === 'new'">
        <div class="align-right ">
            <button type="button" class="btn" ng-click="cancel()" tooltip="{{'Organisaatiot.ohje.palaahakuun' | i18n}}"><i class="icon-arrow-left"></i></button>
            <button type="button" class="btn" ng-disabled="form.$invalid" ng-click="peruutaOrganisaationmuokkaus(form.$dirty)">{{'Organisaatiot.tarkastele'| i18n}}</button>
            <button type="button" ng-disabled="!form.$dirty || form.$invalid" auth="crudOrg" auth-service="APP_ORGANISAATIOHALLINTA" auth-org="{{model.organisaatio.parentOid}}" class="btn btn-primary" ng-click="save()">{{'Organisaationmuokkaus.tallenna'| i18n}}</button>
        </div>
        <span ng-if="!form.$invalid" class="muted" style="background-color: #fff"><em>{{model.savestatus}}</em></span>
        <span ng-if="form.$invalid" class="muted" style="background-color: #fff; color: #f00"><em ng-mouseenter="listErrors()" tooltip-html-unsafe='{{model.errorsTooltip}}'>{{'Organisaationmuokkaus.validation.lomake'| i18n }}</em></span>
    </div>
    <p>
</div>